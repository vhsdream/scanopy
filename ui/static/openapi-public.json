{
  "openapi": "3.1.0",
  "info": {
    "title": "Scanopy API",
    "description": "Network topology discovery and visualization API",
    "license": {
      "name": "Dual (AGPL3.0, Commercial License Available)"
    },
    "version": "0.12.6"
  },
  "paths": {
    "/api/auth/keys": {
      "get": {
        "tags": [
          "api_keys"
        ],
        "summary": "List all api_keys",
        "operationId": "list_api_keys",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of api_keys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_ApiKey"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "api_keys"
        ],
        "summary": "Create API key",
        "operationId": "create_api_key",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API key created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_ApiKeyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Insufficient permissions (admin+ required)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/auth/keys/bulk-delete": {
      "post": {
        "tags": [
          "api_keys"
        ],
        "summary": "Bulk delete api_keys",
        "operationId": "bulk_delete_api_keys",
        "requestBody": {
          "description": "Array of api_keys IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "ApiKeys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/auth/keys/{id}": {
      "get": {
        "tags": [
          "api_keys"
        ],
        "summary": "Get api_key by ID",
        "operationId": "get_api_key_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ApiKey ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ApiKey found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_ApiKey"
                }
              }
            }
          },
          "404": {
            "description": "ApiKey not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "api_keys"
        ],
        "summary": "Update an API key",
        "operationId": "update_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API key updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_ApiKey"
                }
              }
            }
          },
          "404": {
            "description": "API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "api_keys"
        ],
        "summary": "Delete api_key",
        "operationId": "delete_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ApiKey ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ApiKey deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "ApiKey not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/auth/keys/{id}/rotate": {
      "post": {
        "tags": [
          "api_keys"
        ],
        "summary": "Rotate an API key",
        "operationId": "rotate_key_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "API key rotated, returns new key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_String"
                }
              }
            }
          },
          "404": {
            "description": "API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/bindings": {
      "get": {
        "tags": [
          "bindings"
        ],
        "summary": "List all bindings",
        "operationId": "list_bindings",
        "parameters": [
          {
            "name": "service_id",
            "in": "query",
            "description": "Filter by service ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "port_id",
            "in": "query",
            "description": "Filter by port ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "interface_id",
            "in": "query",
            "description": "Filter by interface ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of bindings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Binding"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "bindings"
        ],
        "summary": "Create a new binding",
        "description": "Creates a binding that associates a service with a port or interface.\n\n### Binding Types\n\n- **Interface binding**: Service is present at an interface (IP address) without a specific port.\n  Used for non-port-bound services like gateways.\n- **Port binding (specific interface)**: Service listens on a specific port on a specific interface.\n- **Port binding (all interfaces)**: Service listens on a specific port on all interfaces\n  (`interface_id: null`).\n\n### Validation and Deduplication Rules\n\n- **Conflict detection**: Interface bindings conflict with port bindings on the same interface.\n  A port binding on all interfaces conflicts with any interface binding for the same service.\n- **All-interfaces precedence**: When creating a port binding with `interface_id: null`,\n  any existing specific-interface bindings for the same port are automatically removed,\n  as they are superseded by the all-interfaces binding.",
        "operationId": "create_binding",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Binding"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Binding created (superseded bindings may be removed)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Binding"
                }
              }
            }
          },
          "400": {
            "description": "Referenced port or interface does not exist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict with existing binding type",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/bindings/bulk-delete": {
      "post": {
        "tags": [
          "bindings"
        ],
        "summary": "Bulk delete bindings",
        "operationId": "bulk_delete_bindings",
        "requestBody": {
          "description": "Array of bindings IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bindings deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/bindings/{id}": {
      "get": {
        "tags": [
          "bindings"
        ],
        "summary": "Get binding by ID",
        "operationId": "get_binding_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Binding found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Binding"
                }
              }
            }
          },
          "404": {
            "description": "Binding not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "bindings"
        ],
        "summary": "Update a binding",
        "description": "Updates an existing binding. The same conflict detection rules from binding creation apply.\n\n## Validation Rules\n\n- **Conflict detection**: The updated binding must not conflict with other bindings on the\n  same service. Interface bindings conflict with port bindings on the same interface.",
        "operationId": "update_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Binding"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Binding updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Binding"
                }
              }
            }
          },
          "400": {
            "description": "Referenced port or interface does not exist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict with existing binding type",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "bindings"
        ],
        "summary": "Delete binding",
        "operationId": "delete_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Binding deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Binding not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/daemons": {
      "get": {
        "tags": [
          "daemons"
        ],
        "summary": "List all daemons",
        "operationId": "list_daemons",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of daemons",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Daemon"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/daemons/bulk-delete": {
      "post": {
        "tags": [
          "daemons"
        ],
        "summary": "Bulk delete daemons",
        "operationId": "bulk_delete_daemons",
        "requestBody": {
          "description": "Array of daemons IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Daemons deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/daemons/{id}": {
      "get": {
        "tags": [
          "daemons"
        ],
        "summary": "Get daemon by ID",
        "operationId": "get_daemon_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Daemon"
                }
              }
            }
          },
          "404": {
            "description": "Daemon not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "daemons"
        ],
        "summary": "Delete daemon",
        "operationId": "delete_daemon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Daemon not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "List all discoveries",
        "operationId": "list_discoveries",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "daemon_id",
            "in": "query",
            "description": "Filter by daemon ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of discoveries",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Discovery"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Create new discovery",
        "operationId": "create_discovery",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Discovery"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Discovery"
                }
              }
            }
          },
          "400": {
            "description": "Can't create historical discovery",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/active-sessions": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "Get active discovery sessions",
        "operationId": "get_active_sessions",
        "responses": {
          "200": {
            "description": "List of active discovery sessions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_DiscoveryUpdatePayload"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/bulk-delete": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Bulk delete discoveries",
        "operationId": "bulk_delete_discoveries",
        "requestBody": {
          "description": "Array of discoveries IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discoverys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/start-session": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Start a discovery session",
        "operationId": "start_session",
        "requestBody": {
          "content": {
            "text/plain": {
              "schema": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery session started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_DiscoveryUpdatePayload"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/{id}": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "Get discovery by ID",
        "operationId": "get_discovery_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Discovery"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "discoveries"
        ],
        "summary": "Update discovery",
        "operationId": "update_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Discovery"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Discovery"
                }
              }
            }
          },
          "400": {
            "description": "Can't update historical discovery",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "discoveries"
        ],
        "summary": "Delete discovery",
        "operationId": "delete_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/{session_id}/cancel": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Cancel a discovery session",
        "operationId": "cancel_discovery",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "description": "Session ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery session cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/groups": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "List all groups",
        "operationId": "list_groups",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of groups",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Group"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Create a new group",
        "operationId": "create_group",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Group"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Group"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/groups/bulk-delete": {
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Bulk delete groups",
        "operationId": "bulk_delete_groups",
        "requestBody": {
          "description": "Array of groups IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Groups deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/groups/{id}": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "Get group by ID",
        "operationId": "get_group_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Group"
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "groups"
        ],
        "summary": "Update a group",
        "operationId": "update_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Group"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Group"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "groups"
        ],
        "summary": "Delete group",
        "operationId": "delete_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "List all hosts",
        "description": "Returns all hosts the authenticated user has access to, with their\ninterfaces, ports, and services included.",
        "operationId": "get_all_hosts",
        "responses": {
          "200": {
            "description": "List of hosts with their children",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_HostResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Create a new host",
        "description": "Creates a host with optional interfaces, ports, and services.\nThe `source` field is automatically set to `Manual`.\nIDs for the host and all children are generated server-side.\n\n### Tag Validation\n\n- Tags must exist and belong to your organization\n- Duplicate tag UUIDs are automatically deduplicated\n- Invalid or cross-organization tag UUIDs return a 400 error",
        "operationId": "create_host",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Host created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: network not found, subnet mismatch, or invalid tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No access to the specified network",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts/bulk-delete": {
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Bulk delete hosts",
        "description": "Deletes multiple hosts in a single request. The request body should be\nan array of host IDs to delete. Fails if any host has an associated daemon.",
        "operationId": "bulk_delete_hosts",
        "requestBody": {
          "description": "Array of host IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Hosts deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "409": {
            "description": "One or more hosts has an associated daemon - delete daemons first",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts/{destination_host}/consolidate/{other_host}": {
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Consolidate hosts",
        "description": "Merges all interfaces, ports, and services from `other_host` into\n`destination_host`, then deletes `other_host`. Both hosts must be\non the same network.\n\n### Merge Behavior\n\n- **Interfaces**: Transferred to destination. If an interface with matching subnet+IP or MAC\n  already exists on destination, bindings are remapped to use the existing interface.\n- **Ports**: Transferred to destination. If a port with the same number and protocol already\n  exists, bindings are remapped to use the existing port.\n- **Services**: Transferred to destination with deduplication.\n  See [upsert behavior](https://scanopy.net/docs/discovery/#upsert-behavior) for details.\n\n### Restrictions\n\n- Cannot consolidate a host with itself.\n- Cannot consolidate a host that has a daemon - consolidate into it instead.",
        "operationId": "consolidate_hosts",
        "parameters": [
          {
            "name": "destination_host",
            "in": "path",
            "description": "Destination host ID - will receive all children",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "other_host",
            "in": "path",
            "description": "Host to merge into destination - will be deleted",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Hosts consolidated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: same host, has daemon, or different networks",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "One or both hosts not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts/{id}": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "Get a host by ID",
        "description": "Returns a single host with its interfaces, ports, and services.",
        "operationId": "get_host_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Host found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Update a host",
        "description": "Updates host properties. Children (interfaces, ports, services)\nare managed via their own endpoints.\n\n### Tag Validation\n\n- Tags must exist and belong to your organization\n- Duplicate tag UUIDs are automatically deduplicated\n- Invalid or cross-organization tag UUIDs return a 400 error",
        "operationId": "update_host",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Host updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: invalid tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "hosts"
        ],
        "summary": "Delete a host",
        "description": "Prevents deletion if the host has a daemon associated with it",
        "operationId": "delete_host",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Host deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Host has associated daemon",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/interfaces": {
      "get": {
        "tags": [
          "interfaces"
        ],
        "summary": "List all interfaces",
        "operationId": "list_interfaces",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "subnet_id",
            "in": "query",
            "description": "Filter by subnet ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of interfaces",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Interface"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "interfaces"
        ],
        "summary": "Create a new interface\nPosition is automatically assigned to the end of the host's interface list.",
        "operationId": "create_interface",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Interface"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interface created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Interface"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/interfaces/bulk-delete": {
      "post": {
        "tags": [
          "interfaces"
        ],
        "summary": "Bulk delete interfaces\nRemaining interfaces for affected hosts are renumbered to maintain sequential positions.",
        "operationId": "bulk_delete_interfaces",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interfaces deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "400": {
            "description": "No IDs provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/interfaces/{id}": {
      "get": {
        "tags": [
          "interfaces"
        ],
        "summary": "Get interface by ID",
        "operationId": "get_interface_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Interface found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Interface"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "interfaces"
        ],
        "summary": "Update an interface\nPosition must be within valid range and not conflict with other interfaces.",
        "operationId": "update_interface",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Interface"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interface updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Interface"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "interfaces"
        ],
        "summary": "Delete an interface\nRemaining interfaces for the host are renumbered to maintain sequential positions.",
        "operationId": "delete_interface",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Interface deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/invites": {
      "get": {
        "tags": [
          "invites"
        ],
        "summary": "List all invites",
        "operationId": "get_invites",
        "responses": {
          "200": {
            "description": "List of active invites",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Invite"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "invites"
        ],
        "summary": "Create invite",
        "operationId": "create_invite",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateInviteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Invite created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Invite"
                }
              }
            }
          },
          "403": {
            "description": "Cannot create invite with higher permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/invites/{id}": {
      "get": {
        "tags": [
          "invites"
        ],
        "summary": "Get an invite by ID",
        "operationId": "get_invite",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Invite ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Invite details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Invite"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired invite",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/invites/{id}/revoke": {
      "delete": {
        "tags": [
          "invites"
        ],
        "summary": "Revoke an invite",
        "operationId": "revoke_invite",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Invite ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Invite revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid invite",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot revoke this invite",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/networks": {
      "get": {
        "tags": [
          "networks"
        ],
        "summary": "List all networks",
        "operationId": "list_networks",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of networks",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Network"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "networks"
        ],
        "summary": "Create a new network",
        "operationId": "create_network",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Network"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Network created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Network"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/networks/bulk-delete": {
      "post": {
        "tags": [
          "networks"
        ],
        "summary": "Bulk delete networks",
        "operationId": "bulk_delete_networks",
        "requestBody": {
          "description": "Array of network IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Networks deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "403": {
            "description": "User not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/networks/{id}": {
      "get": {
        "tags": [
          "networks"
        ],
        "summary": "Get network by ID",
        "operationId": "get_network_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Network found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Network"
                }
              }
            }
          },
          "404": {
            "description": "Network not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "networks"
        ],
        "summary": "Update a network",
        "operationId": "update_network",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Network"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Network updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Network"
                }
              }
            }
          },
          "403": {
            "description": "User not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Network not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "networks"
        ],
        "summary": "Delete a network",
        "operationId": "delete_network",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Network deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "403": {
            "description": "User not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Network not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/organizations": {
      "get": {
        "tags": [
          "organizations"
        ],
        "summary": "Get the current user's organization",
        "operationId": "get_organization",
        "responses": {
          "200": {
            "description": "Organization details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Organization"
                }
              }
            }
          },
          "404": {
            "description": "Organization not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/organizations/{id}": {
      "put": {
        "tags": [
          "organizations"
        ],
        "summary": "Update organization name",
        "operationId": "update_org_name",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Organization ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "text/plain": {
              "schema": {
                "type": "string"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Organization updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Organization"
                }
              }
            }
          },
          "403": {
            "description": "Only owners can update organization",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Organization not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/ports": {
      "get": {
        "tags": [
          "ports"
        ],
        "summary": "List all ports",
        "operationId": "list_ports",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of ports",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Port"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "ports"
        ],
        "summary": "Create a new port",
        "operationId": "create_port",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Port"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Port created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Port"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or duplicate port",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/ports/bulk-delete": {
      "post": {
        "tags": [
          "ports"
        ],
        "summary": "Bulk delete ports",
        "operationId": "bulk_delete_ports",
        "requestBody": {
          "description": "Array of ports IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ports deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/ports/{id}": {
      "get": {
        "tags": [
          "ports"
        ],
        "summary": "Get port by ID",
        "operationId": "get_port_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Port found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Port"
                }
              }
            }
          },
          "404": {
            "description": "Port not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "ports"
        ],
        "summary": "Update a port",
        "operationId": "update_port",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Port"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Port updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Port"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Port not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "ports"
        ],
        "summary": "Delete port",
        "operationId": "delete_port",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Port deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Port not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/services": {
      "get": {
        "tags": [
          "services"
        ],
        "summary": "List all services",
        "operationId": "list_services",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of services",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Service"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "services"
        ],
        "summary": "Create a new service",
        "description": "Creates a service with optional bindings to interfaces or ports.\nThe `id`, `created_at`, `updated_at`, and `source` fields are generated server-side.\nBindings are specified without `service_id` or `network_id` - these are assigned automatically.\n\n### Binding Validation Rules\n\n- **Cross-host validation**: All bindings must reference ports/interfaces that belong to the\n  service's host. Bindings referencing entities from other hosts will be rejected.\n- **Deduplication**: Duplicate bindings in the same request are automatically deduplicated.\n- **All-interfaces precedence**: If a port binding with `interface_id: null` (all interfaces)\n  is included, any specific-interface bindings for the same port are automatically removed.\n- **Conflict detection**: Interface bindings conflict with port bindings on the same interface.\n  A port binding on all interfaces conflicts with any interface binding.",
        "operationId": "create_service",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateServiceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Service"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: host network mismatch, cross-host binding, or binding conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/services/bulk-delete": {
      "post": {
        "tags": [
          "services"
        ],
        "summary": "Bulk delete services",
        "operationId": "bulk_delete_services",
        "requestBody": {
          "description": "Array of services IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Services deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/services/{id}": {
      "get": {
        "tags": [
          "services"
        ],
        "summary": "Get service by ID",
        "operationId": "get_service_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Service"
                }
              }
            }
          },
          "404": {
            "description": "Service not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "services"
        ],
        "summary": "Update a service",
        "description": "Updates an existing service. All binding validation rules from service creation apply here as well.\n\n## Binding Validation Rules\n\n- **Cross-host validation**: All bindings must reference ports/interfaces that belong to the\n  service's host. Bindings referencing entities from other hosts will be rejected.\n- **Deduplication**: Duplicate bindings are automatically deduplicated.\n- **All-interfaces precedence**: If a port binding with `interface_id: null` (all interfaces)\n  is included, any specific-interface bindings for the same port are automatically removed.\n- **Conflict detection**: Interface bindings conflict with port bindings on the same interface.",
        "operationId": "update_service",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Service"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Service"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: host network mismatch, cross-host binding, or binding conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Service not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "services"
        ],
        "summary": "Delete service",
        "operationId": "delete_service",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Service not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/shares": {
      "get": {
        "tags": [
          "shares"
        ],
        "summary": "List all shares",
        "operationId": "list_shares",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "topology_id",
            "in": "query",
            "description": "Filter by topology ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of shares",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Share"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "shares"
        ],
        "summary": "Create a new share",
        "operationId": "create_share",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUpdateShareRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Share created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Share"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/shares/bulk-delete": {
      "post": {
        "tags": [
          "shares"
        ],
        "summary": "Bulk delete shares",
        "operationId": "bulk_delete_shares",
        "requestBody": {
          "description": "Array of shares IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Shares deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/shares/public/{id}": {
      "get": {
        "tags": [
          "shares"
        ],
        "summary": "Get share metadata",
        "description": "Does not include any topology data",
        "operationId": "get_public_share_metadata",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Share metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_PublicShareMetadata"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/shares/{id}": {
      "get": {
        "tags": [
          "shares"
        ],
        "summary": "Get share by ID",
        "operationId": "get_share_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Share found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Share"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "shares"
        ],
        "summary": "Update a share",
        "operationId": "update_share",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUpdateShareRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Share updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Share"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "shares"
        ],
        "summary": "Delete share",
        "operationId": "delete_share",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Share deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/subnets": {
      "get": {
        "tags": [
          "subnets"
        ],
        "summary": "List all subnets",
        "operationId": "list_subnets",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of subnets",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Subnet"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "subnets"
        ],
        "summary": "Create a new subnet",
        "operationId": "create_subnet",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Subnet"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnet created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Subnet"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/subnets/bulk-delete": {
      "post": {
        "tags": [
          "subnets"
        ],
        "summary": "Bulk delete subnets",
        "operationId": "bulk_delete_subnets",
        "requestBody": {
          "description": "Array of subnets IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnets deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/subnets/{id}": {
      "get": {
        "tags": [
          "subnets"
        ],
        "summary": "Get subnet by ID",
        "operationId": "get_subnet_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subnet found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Subnet"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "subnets"
        ],
        "summary": "Update a subnet",
        "description": "Updates subnet properties. If the CIDR is being changed, validates that\nall existing interfaces on this subnet have IPs within the new CIDR range.",
        "operationId": "update_subnet",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Subnet"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnet updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Subnet"
                }
              }
            }
          },
          "400": {
            "description": "CIDR change would orphan existing interfaces",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "subnets"
        ],
        "summary": "Delete subnet",
        "operationId": "delete_subnet",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subnet deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/tags": {
      "get": {
        "tags": [
          "tags"
        ],
        "summary": "List all tags",
        "operationId": "list_tags",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Tag"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "tags"
        ],
        "summary": "Create a new tag",
        "description": "Creates a tag scoped to your organization. Tag names must be unique within the organization.\n\n### Validation\n\n- Name must be 1-100 characters (empty names are rejected)\n- Name must be unique within your organization",
        "operationId": "create_tag",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Tag"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: name empty or too long",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Tag name already exists in this organization",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/tags/bulk-delete": {
      "post": {
        "tags": [
          "tags"
        ],
        "summary": "Bulk delete tags",
        "operationId": "bulk_delete_tags",
        "requestBody": {
          "description": "Array of tags IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tags deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/tags/{id}": {
      "get": {
        "tags": [
          "tags"
        ],
        "summary": "Get tag by ID",
        "operationId": "get_tag_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Tag"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "tags"
        ],
        "summary": "Update tag",
        "operationId": "update_tag",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Tag"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "tags"
        ],
        "summary": "Delete tag",
        "operationId": "delete_tag",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/topology/{id}/lock": {
      "post": {
        "tags": [
          "topology"
        ],
        "summary": "Lock a topology",
        "operationId": "lock",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Topology ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Topology"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Topology locked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Topology"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/topology/{id}/unlock": {
      "post": {
        "tags": [
          "topology"
        ],
        "summary": "Unlock a topology",
        "operationId": "unlock",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Topology ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Topology"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Topology unlocked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Topology"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/users": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "List all users",
        "operationId": "get_all_users",
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_User"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/users/bulk-delete": {
      "post": {
        "tags": [
          "users"
        ],
        "summary": "Bulk delete users",
        "operationId": "bulk_delete_users",
        "requestBody": {
          "description": "Array of user IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Users deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot delete users with higher permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ApiErrorResponse": {
        "type": "object",
        "description": "Error response type for API errors (no data field)",
        "required": [
          "success"
        ],
        "properties": {
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiKey": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ApiKeyBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "updated_at",
              "created_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "ApiKeyBase": {
        "type": "object",
        "required": [
          "key",
          "name",
          "last_used",
          "network_id",
          "tags"
        ],
        "properties": {
          "expires_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "key": {
            "type": "string",
            "readOnly": true
          },
          "last_used": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "readOnly": true
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "ApiKeyResponse": {
        "type": "object",
        "required": [
          "api_key",
          "key"
        ],
        "properties": {
          "api_key": {
            "$ref": "#/components/schemas/ApiKey"
          },
          "key": {
            "type": "string"
          }
        }
      },
      "ApiResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/TupleUnit"
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_ApiKey": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ApiKeyBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "updated_at",
                  "created_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_ApiKeyResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "api_key",
              "key"
            ],
            "properties": {
              "api_key": {
                "$ref": "#/components/schemas/ApiKey"
              },
              "key": {
                "type": "string"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Binding": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/BindingBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "description": "Association between a service and a port / interface that the service is listening on",
            "example": {
              "created_at": "2025-12-28T15:52:09.812337Z",
              "id": "6e90eb78-2738-4972-bbf3-3ca97743ad6d",
              "interface_id": "550e8400-e29b-41d4-a716-446655440005",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "port_id": "550e8400-e29b-41d4-a716-446655440006",
              "service_id": "550e8400-e29b-41d4-a716-446655440007",
              "type": "Port",
              "updated_at": "2025-12-28T15:52:09.812337Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_BulkDeleteResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "deleted_count",
              "requested_count"
            ],
            "properties": {
              "deleted_count": {
                "type": "integer",
                "minimum": 0
              },
              "requested_count": {
                "type": "integer",
                "minimum": 0
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Daemon": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DaemonBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "updated_at",
                  "created_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonRegistrationResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Daemon registration response from server to daemon",
            "required": [
              "daemon",
              "host_id"
            ],
            "properties": {
              "daemon": {
                "$ref": "#/components/schemas/Daemon"
              },
              "host_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonSetupResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response from daemon setup endpoint",
            "properties": {
              "api_key": {
                "type": [
                  "string",
                  "null"
                ]
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Discovery": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DiscoveryBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DiscoveryUpdatePayload": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Progress update from daemon to server during discovery",
            "required": [
              "session_id",
              "daemon_id",
              "network_id",
              "phase",
              "discovery_type",
              "progress"
            ],
            "properties": {
              "daemon_id": {
                "type": "string",
                "format": "uuid"
              },
              "discovery_type": {
                "$ref": "#/components/schemas/DiscoveryType"
              },
              "error": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "finished_at": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "phase": {
                "$ref": "#/components/schemas/DiscoveryPhase"
              },
              "progress": {
                "type": "integer",
                "format": "int32",
                "minimum": 0
              },
              "session_id": {
                "type": "string",
                "format": "uuid"
              },
              "started_at": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Group": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GroupBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "binding_ids": [],
              "color": "Blue",
              "created_at": "2026-01-15T10:30:00Z",
              "description": "HTTP/HTTPS services group",
              "edge_style": "Bezier",
              "group_type": "RequestPath",
              "id": "550e8400-e29b-41d4-a716-446655440008",
              "name": "Web Services",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "source": {
                "type": "Manual"
              },
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_HostResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
            "required": [
              "id",
              "created_at",
              "updated_at",
              "name",
              "network_id",
              "source",
              "hidden",
              "tags",
              "interfaces",
              "ports",
              "services"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time"
              },
              "description": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "hidden": {
                "type": "boolean"
              },
              "hostname": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "interfaces": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Interface"
                }
              },
              "name": {
                "type": "string"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "ports": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Port"
                }
              },
              "services": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Service"
                }
              },
              "source": {
                "$ref": "#/components/schemas/EntitySource"
              },
              "tags": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "updated_at": {
                "type": "string",
                "format": "date-time"
              },
              "virtualization": {
                "oneOf": [
                  {
                    "type": "null"
                  },
                  {
                    "$ref": "#/components/schemas/HostVirtualization"
                  }
                ]
              }
            },
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "description": "Primary web server",
              "hidden": false,
              "hostname": "web-server-01.local",
              "id": "550e8400-e29b-41d4-a716-446655440003",
              "interfaces": [
                {
                  "created_at": "2026-01-15T10:30:00Z",
                  "host_id": "550e8400-e29b-41d4-a716-446655440003",
                  "id": "550e8400-e29b-41d4-a716-446655440005",
                  "ip_address": "192.168.1.100",
                  "mac_address": "DE:AD:BE:EF:12:34",
                  "name": "eth0",
                  "network_id": "550e8400-e29b-41d4-a716-446655440002",
                  "position": 0,
                  "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
                  "updated_at": "2026-01-15T10:30:00Z"
                }
              ],
              "name": "web-server-01",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "ports": [
                {
                  "created_at": "2026-01-15T10:30:00Z",
                  "host_id": "550e8400-e29b-41d4-a716-446655440003",
                  "id": "550e8400-e29b-41d4-a716-446655440006",
                  "network_id": "550e8400-e29b-41d4-a716-446655440002",
                  "number": 80,
                  "protocol": "Tcp",
                  "type": "Http",
                  "updated_at": "2026-01-15T10:30:00Z"
                }
              ],
              "services": [],
              "source": {
                "type": "Manual"
              },
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z",
              "virtualization": null
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Interface": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/InterfaceBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440005",
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "position": 0,
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Invite": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/InviteBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_MetadataRegistry": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "service_definitions",
              "subnet_types",
              "edge_types",
              "group_types",
              "entities",
              "ports",
              "discovery_types",
              "billing_plans",
              "features",
              "permissions",
              "concepts"
            ],
            "properties": {
              "billing_plans": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "concepts": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EntityMetadata"
                }
              },
              "discovery_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "edge_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "entities": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EntityMetadata"
                }
              },
              "features": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "group_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "permissions": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "ports": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "service_definitions": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "subnet_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Network": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/NetworkBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "id": "550e8400-e29b-41d4-a716-446655440002",
              "name": "Home Network",
              "organization_id": "550e8400-e29b-41d4-a716-446655440001",
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Organization": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/OrganizationBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Port": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PortBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "description": "Port entity with custom serialization that flattens PortType fields.",
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440006",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "number": 80,
              "protocol": "Tcp",
              "type": "Http",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_PublicConfigResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "server_port",
              "disable_registration",
              "oidc_providers",
              "billing_enabled",
              "has_integrated_daemon",
              "has_email_service",
              "has_email_opt_in",
              "public_url",
              "needs_cookie_consent",
              "deployment_type"
            ],
            "properties": {
              "billing_enabled": {
                "type": "boolean"
              },
              "deployment_type": {
                "$ref": "#/components/schemas/DeploymentType"
              },
              "disable_registration": {
                "type": "boolean"
              },
              "has_email_opt_in": {
                "type": "boolean"
              },
              "has_email_service": {
                "type": "boolean"
              },
              "has_integrated_daemon": {
                "type": "boolean"
              },
              "needs_cookie_consent": {
                "type": "boolean"
              },
              "oidc_providers": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/OidcProviderMetadata"
                }
              },
              "plunk_key": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "posthog_key": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "public_url": {
                "type": "string"
              },
              "server_port": {
                "type": "integer",
                "format": "int32",
                "minimum": 0
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_PublicShareMetadata": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Public share metadata (returned without authentication)",
            "required": [
              "id",
              "name",
              "requires_password",
              "options"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "name": {
                "type": "string"
              },
              "options": {
                "$ref": "#/components/schemas/ShareOptions"
              },
              "requires_password": {
                "type": "boolean"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Service": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ServiceBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "bindings": [
                {
                  "created_at": "2025-12-28T15:52:09.810162Z",
                  "id": "0f1f200e-9b8e-4216-9fe6-77f02ccfdf89",
                  "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                  "network_id": "550e8400-e29b-41d4-a716-446655440002",
                  "port_id": "550e8400-e29b-41d4-a716-446655440006",
                  "service_id": "550e8400-e29b-41d4-a716-446655440007",
                  "type": "Port",
                  "updated_at": "2025-12-28T15:52:09.810162Z"
                }
              ],
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440007",
              "name": "nginx",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "service_definition": "Kerberos",
              "source": {
                "type": "Manual"
              },
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z",
              "virtualization": null
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_SetupResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response from setup endpoint",
            "required": [
              "network_ids"
            ],
            "properties": {
              "network_ids": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Share": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ShareBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_String": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "string"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Subnet": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/SubnetBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "cidr": "192.168.1.0/24",
              "created_at": "2026-01-15T10:30:00Z",
              "description": "Local area network",
              "id": "550e8400-e29b-41d4-a716-446655440004",
              "name": "LAN",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "source": {
                "type": "Manual"
              },
              "subnet_type": "Lan",
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Tag": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TagBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "color": "Green",
              "created_at": "2026-01-15T10:30:00Z",
              "description": "Production environment resources",
              "id": "550e8400-e29b-41d4-a716-44665544000a",
              "name": "production",
              "organization_id": "550e8400-e29b-41d4-a716-446655440001",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Topology": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TopologyBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_User": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/UserBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_ApiKey": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ApiKeyBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "updated_at",
                    "created_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_BillingPlan": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Community"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Starter"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Pro"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Team"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Business"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Enterprise"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Demo"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "CommercialSelfHosted"
                          ]
                        }
                      }
                    }
                  ]
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Binding": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/BindingBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "description": "Association between a service and a port / interface that the service is listening on",
              "example": {
                "created_at": "2025-12-28T15:52:09.812151Z",
                "id": "7b6af22c-5d70-4984-8041-a0259c3e552f",
                "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "port_id": "550e8400-e29b-41d4-a716-446655440006",
                "service_id": "550e8400-e29b-41d4-a716-446655440007",
                "type": "Port",
                "updated_at": "2025-12-28T15:52:09.812151Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Daemon": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DaemonBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "updated_at",
                    "created_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Discovery": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DiscoveryBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_DiscoveryUpdatePayload": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "description": "Progress update from daemon to server during discovery",
              "required": [
                "session_id",
                "daemon_id",
                "network_id",
                "phase",
                "discovery_type",
                "progress"
              ],
              "properties": {
                "daemon_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "discovery_type": {
                  "$ref": "#/components/schemas/DiscoveryType"
                },
                "error": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "finished_at": {
                  "type": [
                    "string",
                    "null"
                  ],
                  "format": "date-time"
                },
                "network_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "phase": {
                  "$ref": "#/components/schemas/DiscoveryPhase"
                },
                "progress": {
                  "type": "integer",
                  "format": "int32",
                  "minimum": 0
                },
                "session_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "started_at": {
                  "type": [
                    "string",
                    "null"
                  ],
                  "format": "date-time"
                }
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Group": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GroupBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "binding_ids": [],
                "color": "Blue",
                "created_at": "2026-01-15T10:30:00Z",
                "description": "HTTP/HTTPS services group",
                "edge_style": "Bezier",
                "group_type": "RequestPath",
                "id": "550e8400-e29b-41d4-a716-446655440008",
                "name": "Web Services",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "source": {
                  "type": "Manual"
                },
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_HostResponse": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
              "required": [
                "id",
                "created_at",
                "updated_at",
                "name",
                "network_id",
                "source",
                "hidden",
                "tags",
                "interfaces",
                "ports",
                "services"
              ],
              "properties": {
                "created_at": {
                  "type": "string",
                  "format": "date-time"
                },
                "description": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "hidden": {
                  "type": "boolean"
                },
                "hostname": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "id": {
                  "type": "string",
                  "format": "uuid"
                },
                "interfaces": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Interface"
                  }
                },
                "name": {
                  "type": "string"
                },
                "network_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "ports": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Port"
                  }
                },
                "services": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Service"
                  }
                },
                "source": {
                  "$ref": "#/components/schemas/EntitySource"
                },
                "tags": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uuid"
                  }
                },
                "updated_at": {
                  "type": "string",
                  "format": "date-time"
                },
                "virtualization": {
                  "oneOf": [
                    {
                      "type": "null"
                    },
                    {
                      "$ref": "#/components/schemas/HostVirtualization"
                    }
                  ]
                }
              },
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "description": "Primary web server",
                "hidden": false,
                "hostname": "web-server-01.local",
                "id": "550e8400-e29b-41d4-a716-446655440003",
                "interfaces": [
                  {
                    "created_at": "2026-01-15T10:30:00Z",
                    "host_id": "550e8400-e29b-41d4-a716-446655440003",
                    "id": "550e8400-e29b-41d4-a716-446655440005",
                    "ip_address": "192.168.1.100",
                    "mac_address": "DE:AD:BE:EF:12:34",
                    "name": "eth0",
                    "network_id": "550e8400-e29b-41d4-a716-446655440002",
                    "position": 0,
                    "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
                    "updated_at": "2026-01-15T10:30:00Z"
                  }
                ],
                "name": "web-server-01",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "ports": [
                  {
                    "created_at": "2026-01-15T10:30:00Z",
                    "host_id": "550e8400-e29b-41d4-a716-446655440003",
                    "id": "550e8400-e29b-41d4-a716-446655440006",
                    "network_id": "550e8400-e29b-41d4-a716-446655440002",
                    "number": 80,
                    "protocol": "Tcp",
                    "type": "Http",
                    "updated_at": "2026-01-15T10:30:00Z"
                  }
                ],
                "services": [],
                "source": {
                  "type": "Manual"
                },
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z",
                "virtualization": null
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Interface": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/InterfaceBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "host_id": "550e8400-e29b-41d4-a716-446655440003",
                "id": "550e8400-e29b-41d4-a716-446655440005",
                "ip_address": "192.168.1.100",
                "mac_address": "DE:AD:BE:EF:12:34",
                "name": "eth0",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "position": 0,
                "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Invite": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/InviteBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Network": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NetworkBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "id": "550e8400-e29b-41d4-a716-446655440002",
                "name": "Home Network",
                "organization_id": "550e8400-e29b-41d4-a716-446655440001",
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Port": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/PortBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "description": "Port entity with custom serialization that flattens PortType fields.",
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "host_id": "550e8400-e29b-41d4-a716-446655440003",
                "id": "550e8400-e29b-41d4-a716-446655440006",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "number": 80,
                "protocol": "Tcp",
                "type": "Http",
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Service": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ServiceBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "bindings": [
                  {
                    "created_at": "2025-12-28T15:52:09.809469Z",
                    "id": "e81a2b19-1795-43e5-a769-cf50413b8c16",
                    "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                    "network_id": "550e8400-e29b-41d4-a716-446655440002",
                    "port_id": "550e8400-e29b-41d4-a716-446655440006",
                    "service_id": "550e8400-e29b-41d4-a716-446655440007",
                    "type": "Port",
                    "updated_at": "2025-12-28T15:52:09.809469Z"
                  }
                ],
                "created_at": "2026-01-15T10:30:00Z",
                "host_id": "550e8400-e29b-41d4-a716-446655440003",
                "id": "550e8400-e29b-41d4-a716-446655440007",
                "name": "nginx",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "service_definition": "Kerberos",
                "source": {
                  "type": "Manual"
                },
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z",
                "virtualization": null
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Share": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ShareBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Subnet": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/SubnetBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "cidr": "192.168.1.0/24",
                "created_at": "2026-01-15T10:30:00Z",
                "description": "Local area network",
                "id": "550e8400-e29b-41d4-a716-446655440004",
                "name": "LAN",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "source": {
                  "type": "Manual"
                },
                "subnet_type": "Lan",
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Tag": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TagBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "color": "Green",
                "created_at": "2026-01-15T10:30:00Z",
                "description": "Production environment resources",
                "id": "550e8400-e29b-41d4-a716-44665544000a",
                "name": "production",
                "organization_id": "550e8400-e29b-41d4-a716-446655440001",
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Topology": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TopologyBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_User": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/UserBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_bool": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "boolean"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_u32": {
        "type": "object",
        "required": [
          "success"
        ],
        "properties": {
          "data": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "BillingPlan": {
        "oneOf": [
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Community"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Starter"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Pro"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Team"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Business"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Enterprise"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Demo"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "CommercialSelfHosted"
                    ]
                  }
                }
              }
            ]
          }
        ]
      },
      "BillingRate": {
        "type": "string",
        "enum": [
          "Month",
          "Year"
        ]
      },
      "Binding": {
        "allOf": [
          {
            "$ref": "#/components/schemas/BindingBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "description": "Association between a service and a port / interface that the service is listening on",
        "example": {
          "created_at": "2025-12-28T15:52:09.805878Z",
          "id": "c980b652-52bf-4b22-ac9d-1d746b71519b",
          "interface_id": "550e8400-e29b-41d4-a716-446655440005",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "port_id": "550e8400-e29b-41d4-a716-446655440006",
          "service_id": "550e8400-e29b-41d4-a716-446655440007",
          "type": "Port",
          "updated_at": "2025-12-28T15:52:09.805878Z"
        }
      },
      "BindingBase": {
        "allOf": [
          {
            "$ref": "#/components/schemas/BindingType"
          },
          {
            "type": "object",
            "required": [
              "service_id",
              "network_id"
            ],
            "properties": {
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "service_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "description": "The base data for a Binding entity (everything except id, created_at, updated_at)"
      },
      "BindingType": {
        "oneOf": [
          {
            "type": "object",
            "title": "Interface",
            "description": "Interface binding: Service is present at an interface (IP address) without a specific port.\nUsed for non-port-bound services like gateways. Conflicts with port bindings on the same interface.",
            "required": [
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Port",
            "description": "Port binding: Service listens on a specific port, optionally on a specific interface.\nIf `interface_id` is `null`, the service listens on this port across all interfaces,\nwhich supersedes any specific-interface bindings for the same port.",
            "required": [
              "port_id",
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid",
                "description": "The interface this port binding applies to. If `null`, the binding applies to all\ninterfaces on the host (and supersedes specific-interface bindings for this port)."
              },
              "port_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Port"
                ]
              }
            }
          }
        ],
        "description": "The type of binding - either to an interface or to a port.\n\nBindings associate a service with network resources (interfaces/ports) on a host.\n\n## Validation Rules\n\n- All bindings must reference ports/interfaces that belong to the same host as the service.\n- Interface bindings conflict with port bindings on the same interface.\n- A port binding on all interfaces (`interface_id: null`) conflicts with any interface binding.\n- When a port binding with `interface_id: null` is created, it supersedes (removes) any\n  existing specific-interface bindings for the same port."
      },
      "BulkDeleteResponse": {
        "type": "object",
        "required": [
          "deleted_count",
          "requested_count"
        ],
        "properties": {
          "deleted_count": {
            "type": "integer",
            "minimum": 0
          },
          "requested_count": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "Color": {
        "type": "string",
        "enum": [
          "Pink",
          "Rose",
          "Red",
          "Orange",
          "Green",
          "Emerald",
          "Teal",
          "Cyan",
          "Blue",
          "Indigo",
          "Purple",
          "Gray",
          "Yellow"
        ]
      },
      "CreateBindingInput": {
        "oneOf": [
          {
            "type": "object",
            "title": "Interface",
            "description": "Bind to an interface (service listens on all ports on this interface)",
            "required": [
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Port",
            "description": "Bind to a port (optionally on a specific interface)",
            "required": [
              "port_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid"
              },
              "port_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Port"
                ]
              }
            }
          }
        ],
        "description": "Input for creating a binding with a service.\n`service_id` and `network_id` are assigned by the server after the service is created."
      },
      "CreateCheckoutRequest": {
        "type": "object",
        "required": [
          "plan",
          "url"
        ],
        "properties": {
          "plan": {
            "$ref": "#/components/schemas/BillingPlan"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "CreateHostRequest": {
        "type": "object",
        "description": "Request type for creating a host with its associated interfaces and ports.\nServer assigns `host_id`, `network_id`, and `source` to all children.\nSource is automatically set based on how the entity was created (API vs UI).\n\nNote: Services are created separately via `POST /api/services` after the host exists,\nas service bindings require the real IDs of the interfaces/ports to reference.",
        "required": [
          "name",
          "network_id",
          "tags"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateInterfaceInput"
            }
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreatePortInput"
            }
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        },
        "example": {
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "interfaces": [
            {
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "position": 0,
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004"
            }
          ],
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "ports": [
            {
              "number": 80,
              "protocol": "Tcp"
            }
          ],
          "tags": [],
          "virtualization": null
        }
      },
      "CreateInterfaceInput": {
        "type": "object",
        "description": "Input for creating an interface with a host.\n`host_id` and `network_id` are assigned by the server.",
        "required": [
          "subnet_id",
          "ip_address"
        ],
        "properties": {
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "position": {
            "type": "integer",
            "format": "int32",
            "description": "Position of this interface in the host's interface list (for ordering)"
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CreateInviteRequest": {
        "type": "object",
        "required": [
          "permissions",
          "network_ids"
        ],
        "properties": {
          "expiration_hours": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "send_to": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "CreatePortInput": {
        "type": "object",
        "description": "Input for creating a port with a host.\n`host_id` and `network_id` are assigned by the server.\nThe port is specified by number and protocol (e.g., 80/tcp, 443/tcp).",
        "required": [
          "number",
          "protocol"
        ],
        "properties": {
          "number": {
            "type": "integer",
            "format": "int32",
            "description": "Port number (1-65535)",
            "minimum": 0
          },
          "protocol": {
            "$ref": "#/components/schemas/TransportProtocol",
            "description": "Transport protocol (Tcp or Udp)"
          }
        }
      },
      "CreateServiceRequest": {
        "type": "object",
        "description": "Request type for creating a service.\nServer assigns `id`, `created_at`, `updated_at`, and `source`.\nServer also assigns `service_id` and `network_id` to all bindings.",
        "required": [
          "host_id",
          "network_id",
          "service_definition",
          "name",
          "tags"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateBindingInput"
            },
            "description": "Bindings to create with the service.\n`service_id` and `network_id` are assigned by the server."
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "service_definition": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServiceVirtualization"
              }
            ]
          }
        }
      },
      "CreateUpdateShareRequest": {
        "type": "object",
        "required": [
          "share"
        ],
        "properties": {
          "password": {
            "type": [
              "string",
              "null"
            ]
          },
          "share": {
            "$ref": "#/components/schemas/Share"
          }
        }
      },
      "Daemon": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DaemonBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "updated_at",
              "created_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DaemonBase": {
        "type": "object",
        "required": [
          "host_id",
          "network_id",
          "url",
          "last_seen",
          "capabilities",
          "mode",
          "name",
          "tags"
        ],
        "properties": {
          "capabilities": {
            "$ref": "#/components/schemas/DaemonCapabilities"
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "last_seen": {
            "type": "string",
            "format": "date-time",
            "readOnly": true
          },
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "url": {
            "type": "string",
            "readOnly": true
          }
        }
      },
      "DaemonCapabilities": {
        "type": "object",
        "description": "Daemon capabilities",
        "required": [
          "interfaced_subnet_ids"
        ],
        "properties": {
          "has_docker_socket": {
            "type": "boolean"
          },
          "interfaced_subnet_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DaemonHeartbeatPayload": {
        "type": "object",
        "required": [
          "url",
          "name",
          "mode"
        ],
        "properties": {
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "DaemonMode": {
        "type": "string",
        "enum": [
          "Push",
          "Pull"
        ]
      },
      "DaemonRegistrationRequest": {
        "type": "object",
        "description": "Daemon registration request from daemon to server",
        "required": [
          "daemon_id",
          "network_id",
          "name",
          "url",
          "mode",
          "capabilities"
        ],
        "properties": {
          "capabilities": {
            "$ref": "#/components/schemas/DaemonCapabilities"
          },
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "DaemonRegistrationResponse": {
        "type": "object",
        "description": "Daemon registration response from server to daemon",
        "required": [
          "daemon",
          "host_id"
        ],
        "properties": {
          "daemon": {
            "$ref": "#/components/schemas/Daemon"
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "DaemonSetupRequest": {
        "type": "object",
        "description": "Daemon setup request for pre-registration daemon configuration",
        "required": [
          "daemon_name",
          "network_id"
        ],
        "properties": {
          "daemon_name": {
            "type": "string"
          },
          "install_later": {
            "type": "boolean"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "DaemonSetupResponse": {
        "type": "object",
        "description": "Response from daemon setup endpoint",
        "properties": {
          "api_key": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "DeploymentType": {
        "type": "string",
        "enum": [
          "cloud",
          "commercial",
          "community"
        ]
      },
      "Discovery": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DiscoveryBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DiscoveryBase": {
        "type": "object",
        "required": [
          "discovery_type",
          "run_type",
          "name",
          "daemon_id",
          "network_id",
          "tags"
        ],
        "properties": {
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "discovery_type": {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "run_type": {
            "$ref": "#/components/schemas/RunType"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DiscoveryHostRequest": {
        "type": "object",
        "description": "Request type for daemon discovery - accepts full entities with IDs.\nUsed internally by daemons for host creation/upsert, NOT the external API.\nThis supports the discovery workflow where daemons manage entity IDs.",
        "required": [
          "host",
          "interfaces",
          "ports",
          "services"
        ],
        "properties": {
          "host": {
            "$ref": "#/components/schemas/Host"
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          }
        }
      },
      "DiscoveryMetadata": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          {
            "type": "object",
            "required": [
              "daemon_id",
              "date"
            ],
            "properties": {
              "daemon_id": {
                "type": "string",
                "format": "uuid"
              },
              "date": {
                "type": "string",
                "format": "date-time"
              }
            }
          }
        ]
      },
      "DiscoveryPhase": {
        "type": "string",
        "enum": [
          "Pending",
          "Starting",
          "Started",
          "Scanning",
          "Complete",
          "Failed",
          "Cancelled"
        ]
      },
      "DiscoveryType": {
        "oneOf": [
          {
            "type": "object",
            "title": "SelfReport",
            "required": [
              "host_id",
              "type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "SelfReport"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Network",
            "required": [
              "subnet_ids",
              "host_naming_fallback",
              "type"
            ],
            "properties": {
              "host_naming_fallback": {
                "$ref": "#/components/schemas/HostNamingFallback"
              },
              "subnet_ids": {
                "type": [
                  "array",
                  "null"
                ],
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "Network"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Docker",
            "required": [
              "host_id",
              "host_naming_fallback",
              "type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "host_naming_fallback": {
                "$ref": "#/components/schemas/HostNamingFallback"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Docker"
                ]
              }
            }
          }
        ]
      },
      "DiscoveryUpdatePayload": {
        "type": "object",
        "description": "Progress update from daemon to server during discovery",
        "required": [
          "session_id",
          "daemon_id",
          "network_id",
          "phase",
          "discovery_type",
          "progress"
        ],
        "properties": {
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "discovery_type": {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "finished_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "phase": {
            "$ref": "#/components/schemas/DiscoveryPhase"
          },
          "progress": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "session_id": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "DockerVirtualization": {
        "type": "object",
        "required": [
          "service_id"
        ],
        "properties": {
          "container_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "container_name": {
            "type": [
              "string",
              "null"
            ]
          },
          "service_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "Edge": {
        "allOf": [
          {
            "$ref": "#/components/schemas/EdgeType"
          },
          {
            "type": "object",
            "required": [
              "id",
              "source",
              "target",
              "label",
              "source_handle",
              "target_handle",
              "is_multi_hop"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "is_multi_hop": {
                "type": "boolean"
              },
              "label": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "source": {
                "type": "string",
                "format": "uuid"
              },
              "source_handle": {
                "$ref": "#/components/schemas/EdgeHandle"
              },
              "target": {
                "type": "string",
                "format": "uuid"
              },
              "target_handle": {
                "$ref": "#/components/schemas/EdgeHandle"
              }
            }
          }
        ]
      },
      "EdgeHandle": {
        "type": "string",
        "enum": [
          "Top",
          "Bottom",
          "Left",
          "Right"
        ]
      },
      "EdgeStyle": {
        "type": "string",
        "enum": [
          "Straight",
          "SmoothStep",
          "Step",
          "Bezier",
          "SimpleBezier"
        ]
      },
      "EdgeType": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "host_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              },
              "host_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "vm_service_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "HostVirtualization"
                ]
              },
              "vm_service_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "host_id",
              "containerizing_service_id",
              "edge_type"
            ],
            "properties": {
              "containerizing_service_id": {
                "type": "string",
                "format": "uuid"
              },
              "edge_type": {
                "type": "string",
                "enum": [
                  "ServiceVirtualization"
                ]
              },
              "host_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "group_id",
              "source_binding_id",
              "target_binding_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "RequestPath"
                ]
              },
              "group_id": {
                "type": "string",
                "format": "uuid"
              },
              "source_binding_id": {
                "type": "string",
                "format": "uuid"
              },
              "target_binding_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "group_id",
              "source_binding_id",
              "target_binding_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "HubAndSpoke"
                ]
              },
              "group_id": {
                "type": "string",
                "format": "uuid"
              },
              "source_binding_id": {
                "type": "string",
                "format": "uuid"
              },
              "target_binding_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ]
      },
      "EdgeTypeDiscriminants": {
        "type": "string",
        "enum": [
          "Interface",
          "HostVirtualization",
          "ServiceVirtualization",
          "RequestPath",
          "HubAndSpoke"
        ]
      },
      "EntityMetadata": {
        "type": "object",
        "required": [
          "id",
          "color",
          "icon"
        ],
        "properties": {
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "icon": {
            "type": "string"
          },
          "id": {
            "type": "string"
          }
        }
      },
      "EntitySource": {
        "oneOf": [
          {
            "type": "object",
            "title": "Manual",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "Manual"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "System",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "System"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Discovery",
            "required": [
              "metadata",
              "type"
            ],
            "properties": {
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DiscoveryMetadata"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "Discovery"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "DiscoveryWithMatch",
            "required": [
              "metadata",
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/MatchDetails"
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DiscoveryMetadata"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "DiscoveryWithMatch"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Unknown",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "Unknown"
                ]
              }
            }
          }
        ]
      },
      "ForgotPasswordRequest": {
        "type": "object",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          }
        }
      },
      "Group": {
        "allOf": [
          {
            "$ref": "#/components/schemas/GroupBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "binding_ids": [],
          "color": "Blue",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "HTTP/HTTPS services group",
          "edge_style": "Bezier",
          "group_type": "RequestPath",
          "id": "550e8400-e29b-41d4-a716-446655440008",
          "name": "Web Services",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "GroupBase": {
        "type": "object",
        "required": [
          "name",
          "network_id",
          "group_type",
          "binding_ids",
          "color",
          "edge_style",
          "tags"
        ],
        "properties": {
          "binding_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Ordered list of binding IDs for this group."
          },
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "edge_style": {
            "$ref": "#/components/schemas/EdgeStyle"
          },
          "group_type": {
            "$ref": "#/components/schemas/GroupType"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource",
            "description": "Will be automatically set to Manual for creation through API"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "GroupType": {
        "type": "string",
        "enum": [
          "RequestPath",
          "HubAndSpoke"
        ]
      },
      "Host": {
        "allOf": [
          {
            "$ref": "#/components/schemas/HostBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "id": "550e8400-e29b-41d4-a716-446655440003",
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "HostBase": {
        "type": "object",
        "description": "Base data for a Host entity (stored in database).\nChild entities (interfaces, ports, services) are stored in their own tables\nand queried by `host_id`. They are NOT stored on the host.",
        "required": [
          "name",
          "network_id",
          "hostname",
          "description",
          "source",
          "virtualization",
          "hidden",
          "tags"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        }
      },
      "HostNamingFallback": {
        "type": "string",
        "enum": [
          "Ip",
          "BestService"
        ]
      },
      "HostResponse": {
        "type": "object",
        "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
        "required": [
          "id",
          "created_at",
          "updated_at",
          "name",
          "network_id",
          "source",
          "hidden",
          "tags",
          "interfaces",
          "ports",
          "services"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        },
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "id": "550e8400-e29b-41d4-a716-446655440003",
          "interfaces": [
            {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440005",
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "position": 0,
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          ],
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "ports": [
            {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440006",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "number": 80,
              "protocol": "Tcp",
              "type": "Http",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          ],
          "services": [],
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "HostVirtualization": {
        "oneOf": [
          {
            "type": "object",
            "title": "Proxmox",
            "required": [
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/ProxmoxVirtualization"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Proxmox"
                ]
              }
            }
          }
        ],
        "title": "HostVirtualization"
      },
      "Interface": {
        "allOf": [
          {
            "$ref": "#/components/schemas/InterfaceBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440005",
          "ip_address": "192.168.1.100",
          "mac_address": "DE:AD:BE:EF:12:34",
          "name": "eth0",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "position": 0,
          "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "InterfaceBase": {
        "type": "object",
        "required": [
          "network_id",
          "host_id",
          "subnet_id",
          "ip_address",
          "mac_address",
          "name"
        ],
        "properties": {
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "position": {
            "type": "integer",
            "format": "int32",
            "description": "Position of this interface in the host's interface list (for ordering)"
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "Invite": {
        "allOf": [
          {
            "$ref": "#/components/schemas/InviteBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "InviteBase": {
        "type": "object",
        "required": [
          "organization_id",
          "permissions",
          "network_ids",
          "url",
          "created_by",
          "expires_at",
          "send_to"
        ],
        "properties": {
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "send_to": {
            "type": [
              "string",
              "null"
            ],
            "description": "Optional email address to send the invite to"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "Ixy": {
        "type": "object",
        "required": [
          "x",
          "y"
        ],
        "properties": {
          "x": {
            "type": "integer"
          },
          "y": {
            "type": "integer"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "description": "Login request from client",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          },
          "password": {
            "type": "string"
          }
        }
      },
      "MatchConfidence": {
        "type": "string",
        "enum": [
          "NotApplicable",
          "Low",
          "Medium",
          "High",
          "Certain"
        ]
      },
      "MatchDetails": {
        "type": "object",
        "required": [
          "reason",
          "confidence"
        ],
        "properties": {
          "confidence": {
            "$ref": "#/components/schemas/MatchConfidence"
          },
          "reason": {
            "$ref": "#/components/schemas/MatchReason"
          }
        }
      },
      "MatchReason": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "type",
              "data"
            ],
            "properties": {
              "data": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "reason"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "type",
              "data"
            ],
            "properties": {
              "data": {
                "type": "array",
                "items": {},
                "description": "Tuple of [name: string, children: MatchReason[]]"
              },
              "type": {
                "type": "string",
                "enum": [
                  "container"
                ]
              }
            }
          }
        ],
        "description": "Match reason - either a simple reason string or a container with nested reasons"
      },
      "MetadataRegistry": {
        "type": "object",
        "required": [
          "service_definitions",
          "subnet_types",
          "edge_types",
          "group_types",
          "entities",
          "ports",
          "discovery_types",
          "billing_plans",
          "features",
          "permissions",
          "concepts"
        ],
        "properties": {
          "billing_plans": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "concepts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntityMetadata"
            }
          },
          "discovery_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "edge_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "entities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntityMetadata"
            }
          },
          "features": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "group_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "service_definitions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "subnet_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          }
        }
      },
      "Network": {
        "allOf": [
          {
            "$ref": "#/components/schemas/NetworkBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "id": "550e8400-e29b-41d4-a716-446655440002",
          "name": "Home Network",
          "organization_id": "550e8400-e29b-41d4-a716-446655440001",
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "NetworkBase": {
        "type": "object",
        "required": [
          "name",
          "organization_id",
          "tags"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "NetworkSetup": {
        "type": "object",
        "description": "Network configuration for setup",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string"
          }
        }
      },
      "Node": {
        "allOf": [
          {
            "$ref": "#/components/schemas/NodeType"
          },
          {
            "type": "object",
            "required": [
              "id",
              "position",
              "size"
            ],
            "properties": {
              "header": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "position": {
                "$ref": "#/components/schemas/Ixy"
              },
              "size": {
                "$ref": "#/components/schemas/Uxy"
              }
            }
          }
        ]
      },
      "NodeType": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "infra_width",
              "node_type"
            ],
            "properties": {
              "infra_width": {
                "type": "integer",
                "minimum": 0
              },
              "node_type": {
                "type": "string",
                "enum": [
                  "SubnetNode"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "subnet_id",
              "host_id",
              "is_infra",
              "node_type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid"
              },
              "is_infra": {
                "type": "boolean"
              },
              "node_type": {
                "type": "string",
                "enum": [
                  "InterfaceNode"
                ]
              },
              "subnet_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ]
      },
      "OidcProviderMetadata": {
        "type": "object",
        "required": [
          "name",
          "slug"
        ],
        "properties": {
          "logo": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          }
        }
      },
      "Organization": {
        "allOf": [
          {
            "$ref": "#/components/schemas/OrganizationBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "OrganizationBase": {
        "type": "object",
        "required": [
          "name",
          "plan",
          "plan_status",
          "onboarding"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "onboarding": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TelemetryOperation"
            }
          },
          "plan": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/BillingPlan"
              }
            ]
          },
          "plan_status": {
            "type": [
              "string",
              "null"
            ],
            "readOnly": true
          }
        }
      },
      "PlanConfig": {
        "type": "object",
        "required": [
          "base_cents",
          "rate",
          "trial_days"
        ],
        "properties": {
          "base_cents": {
            "type": "integer",
            "format": "int64"
          },
          "included_networks": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "minimum": 0
          },
          "included_seats": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "minimum": 0
          },
          "network_cents": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "rate": {
            "$ref": "#/components/schemas/BillingRate"
          },
          "seat_cents": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "trial_days": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "Port": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PortBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "description": "Port entity with custom serialization that flattens PortType fields.",
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440006",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "number": 80,
          "protocol": "Tcp",
          "type": "Http",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "PortBase": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PortType"
          },
          {
            "type": "object",
            "required": [
              "host_id",
              "network_id"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "description": "The base data for a Port entity (everything except id, created_at, updated_at)"
      },
      "PortType": {
        "type": "object",
        "description": "Port type with number, protocol, and optional type identifier",
        "required": [
          "number",
          "protocol"
        ],
        "properties": {
          "number": {
            "type": "integer"
          },
          "protocol": {
            "type": "string",
            "enum": [
              "Udp",
              "Tcp"
            ]
          },
          "type": {
            "type": "string",
            "description": "Auto-derived from number+protocol; optional on create"
          }
        }
      },
      "ProxmoxVirtualization": {
        "type": "object",
        "required": [
          "service_id"
        ],
        "properties": {
          "service_id": {
            "type": "string",
            "format": "uuid"
          },
          "vm_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "vm_name": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "PublicConfigResponse": {
        "type": "object",
        "required": [
          "server_port",
          "disable_registration",
          "oidc_providers",
          "billing_enabled",
          "has_integrated_daemon",
          "has_email_service",
          "has_email_opt_in",
          "public_url",
          "needs_cookie_consent",
          "deployment_type"
        ],
        "properties": {
          "billing_enabled": {
            "type": "boolean"
          },
          "deployment_type": {
            "$ref": "#/components/schemas/DeploymentType"
          },
          "disable_registration": {
            "type": "boolean"
          },
          "has_email_opt_in": {
            "type": "boolean"
          },
          "has_email_service": {
            "type": "boolean"
          },
          "has_integrated_daemon": {
            "type": "boolean"
          },
          "needs_cookie_consent": {
            "type": "boolean"
          },
          "oidc_providers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OidcProviderMetadata"
            }
          },
          "plunk_key": {
            "type": [
              "string",
              "null"
            ]
          },
          "posthog_key": {
            "type": [
              "string",
              "null"
            ]
          },
          "public_url": {
            "type": "string"
          },
          "server_port": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "PublicShareMetadata": {
        "type": "object",
        "description": "Public share metadata (returned without authentication)",
        "required": [
          "id",
          "name",
          "requires_password",
          "options"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "options": {
            "$ref": "#/components/schemas/ShareOptions"
          },
          "requires_password": {
            "type": "boolean"
          }
        }
      },
      "RegisterRequest": {
        "type": "object",
        "description": "Registration request from client",
        "required": [
          "email",
          "password",
          "terms_accepted"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          },
          "password": {
            "type": "string"
          },
          "terms_accepted": {
            "type": "boolean"
          }
        }
      },
      "ResetPasswordRequest": {
        "type": "object",
        "required": [
          "token",
          "password"
        ],
        "properties": {
          "password": {
            "type": "string"
          },
          "token": {
            "type": "string"
          }
        }
      },
      "RunType": {
        "oneOf": [
          {
            "type": "object",
            "title": "Scheduled",
            "required": [
              "cron_schedule",
              "enabled",
              "type"
            ],
            "properties": {
              "cron_schedule": {
                "type": "string"
              },
              "enabled": {
                "type": "boolean"
              },
              "last_run": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time",
                "readOnly": true
              },
              "type": {
                "type": "string",
                "enum": [
                  "Scheduled"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Historical",
            "description": "Historical discovery runs are created by the server and cannot be submitted via API",
            "required": [
              "results",
              "type"
            ],
            "properties": {
              "results": {
                "$ref": "#/components/schemas/DiscoveryUpdatePayload"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Historical"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "AdHoc",
            "required": [
              "type"
            ],
            "properties": {
              "last_run": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time",
                "readOnly": true
              },
              "type": {
                "type": "string",
                "enum": [
                  "AdHoc"
                ]
              }
            }
          }
        ]
      },
      "Service": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ServiceBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "bindings": [
            {
              "created_at": "2025-12-28T15:52:09.805833Z",
              "id": "959f2f2f-917b-48f6-8420-dacacf4de39a",
              "interface_id": "550e8400-e29b-41d4-a716-446655440005",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "port_id": "550e8400-e29b-41d4-a716-446655440006",
              "service_id": "550e8400-e29b-41d4-a716-446655440007",
              "type": "Port",
              "updated_at": "2025-12-28T15:52:09.805833Z"
            }
          ],
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440007",
          "name": "nginx",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "service_definition": "Kerberos",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "ServiceBase": {
        "type": "object",
        "required": [
          "host_id",
          "network_id",
          "service_definition",
          "name",
          "bindings",
          "source",
          "tags"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Binding"
            }
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "service_definition": {
            "type": "string"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource",
            "description": "Will be automatically set to Manual for creation through API"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServiceVirtualization"
              }
            ]
          }
        }
      },
      "ServiceCategory": {
        "type": "string",
        "enum": [
          "NetworkCore",
          "NetworkAccess",
          "NetworkSecurity",
          "Storage",
          "Backup",
          "Media",
          "HomeAutomation",
          "Virtualization",
          "DNS",
          "VPN",
          "Monitoring",
          "AdBlock",
          "ReverseProxy",
          "Workstation",
          "Mobile",
          "IoT",
          "Printer",
          "Database",
          "Development",
          "Dashboard",
          "MessageQueue",
          "IdentityAndAccess",
          "Office",
          "ProjectManagement",
          "Messaging",
          "Conferencing",
          "Telephony",
          "Email",
          "Publishing",
          "Unknown",
          "Custom",
          "Scanopy",
          "OpenPorts"
        ]
      },
      "ServiceVirtualization": {
        "oneOf": [
          {
            "type": "object",
            "title": "Docker",
            "required": [
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/DockerVirtualization"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Docker"
                ]
              }
            }
          }
        ],
        "title": "ServiceVirtualization"
      },
      "SetupRequest": {
        "type": "object",
        "description": "Setup request for pre-registration org/network configuration",
        "required": [
          "organization_name",
          "networks"
        ],
        "properties": {
          "networks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NetworkSetup"
            }
          },
          "organization_name": {
            "type": "string"
          }
        }
      },
      "SetupResponse": {
        "type": "object",
        "description": "Response from setup endpoint",
        "required": [
          "network_ids"
        ],
        "properties": {
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "Share": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ShareBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "ShareBase": {
        "type": "object",
        "required": [
          "topology_id",
          "network_id",
          "created_by",
          "name",
          "is_enabled",
          "expires_at",
          "allowed_domains",
          "options"
        ],
        "properties": {
          "allowed_domains": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "type": "string"
            }
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "expires_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "options": {
            "$ref": "#/components/schemas/ShareOptions"
          },
          "topology_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ShareOptions": {
        "type": "object",
        "description": "Share display options",
        "required": [
          "show_inspect_panel",
          "show_zoom_controls",
          "show_export_button"
        ],
        "properties": {
          "show_export_button": {
            "type": "boolean"
          },
          "show_inspect_panel": {
            "type": "boolean"
          },
          "show_zoom_controls": {
            "type": "boolean"
          }
        }
      },
      "Subnet": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SubnetBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "cidr": "192.168.1.0/24",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Local area network",
          "id": "550e8400-e29b-41d4-a716-446655440004",
          "name": "LAN",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "subnet_type": "Lan",
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "SubnetBase": {
        "type": "object",
        "required": [
          "cidr",
          "network_id",
          "name",
          "subnet_type",
          "source",
          "tags"
        ],
        "properties": {
          "cidr": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource",
            "description": "Will be automatically set to Manual for creation through API"
          },
          "subnet_type": {
            "$ref": "#/components/schemas/SubnetType"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "SubnetType": {
        "type": "string",
        "enum": [
          "Internet",
          "Remote",
          "Gateway",
          "VpnTunnel",
          "Dmz",
          "Lan",
          "WiFi",
          "IoT",
          "Guest",
          "DockerBridge",
          "Management",
          "Storage",
          "Unknown",
          "None"
        ]
      },
      "Tag": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TagBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "color": "Green",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Production environment resources",
          "id": "550e8400-e29b-41d4-a716-44665544000a",
          "name": "production",
          "organization_id": "550e8400-e29b-41d4-a716-446655440001",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "TagBase": {
        "type": "object",
        "required": [
          "name",
          "color",
          "organization_id"
        ],
        "properties": {
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TelemetryOperation": {
        "type": "string",
        "enum": [
          "OrgCreated",
          "OnboardingModalCompleted",
          "PersonalPlanSelected",
          "CommercialPlanSelected",
          "FirstApiKeyCreated",
          "FirstDaemonRegistered",
          "FirstTopologyRebuild"
        ]
      },
      "Topology": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TopologyBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "TopologyBase": {
        "type": "object",
        "required": [
          "name",
          "options",
          "network_id",
          "tags",
          "nodes",
          "edges",
          "hosts",
          "interfaces",
          "ports",
          "bindings",
          "subnets",
          "services",
          "groups",
          "is_stale",
          "last_refreshed",
          "is_locked",
          "removed_hosts",
          "removed_interfaces",
          "removed_subnets",
          "removed_services",
          "removed_groups",
          "removed_ports",
          "removed_bindings"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Binding"
            }
          },
          "edges": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Edge"
            }
          },
          "groups": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Group"
            }
          },
          "hosts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Host"
            }
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "is_locked": {
            "type": "boolean"
          },
          "is_stale": {
            "type": "boolean"
          },
          "last_refreshed": {
            "type": "string",
            "format": "date-time"
          },
          "locked_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "locked_by": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "nodes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Node"
            }
          },
          "options": {
            "$ref": "#/components/schemas/TopologyOptions"
          },
          "parent_id": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "removed_bindings": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_groups": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_hosts": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_interfaces": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_ports": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_services": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_subnets": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          },
          "subnets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Subnet"
            }
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "TopologyLocalOptions": {
        "type": "object",
        "required": [
          "left_zone_title",
          "no_fade_edges",
          "hide_resize_handles",
          "hide_edge_types"
        ],
        "properties": {
          "hide_edge_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EdgeTypeDiscriminants"
            }
          },
          "hide_resize_handles": {
            "type": "boolean"
          },
          "left_zone_title": {
            "type": "string"
          },
          "no_fade_edges": {
            "type": "boolean"
          }
        }
      },
      "TopologyOptions": {
        "type": "object",
        "required": [
          "local",
          "request"
        ],
        "properties": {
          "local": {
            "$ref": "#/components/schemas/TopologyLocalOptions"
          },
          "request": {
            "$ref": "#/components/schemas/TopologyRequestOptions"
          }
        }
      },
      "TopologyRequestOptions": {
        "type": "object",
        "required": [
          "group_docker_bridges_by_host",
          "hide_vm_title_on_docker_container",
          "hide_ports",
          "left_zone_service_categories",
          "hide_service_categories",
          "show_gateway_in_left_zone"
        ],
        "properties": {
          "group_docker_bridges_by_host": {
            "type": "boolean"
          },
          "hide_ports": {
            "type": "boolean"
          },
          "hide_service_categories": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceCategory"
            }
          },
          "hide_vm_title_on_docker_container": {
            "type": "boolean"
          },
          "left_zone_service_categories": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceCategory"
            }
          },
          "show_gateway_in_left_zone": {
            "type": "boolean"
          }
        }
      },
      "TransportProtocol": {
        "type": "string",
        "enum": [
          "Udp",
          "Tcp"
        ]
      },
      "TypeMetadata": {
        "type": "object",
        "required": [
          "id",
          "name",
          "description",
          "category",
          "icon",
          "color",
          "metadata"
        ],
        "properties": {
          "category": {
            "type": [
              "string",
              "null"
            ]
          },
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "icon": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string"
          },
          "metadata": {},
          "name": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "UpdateEmailPasswordRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": [
              "string",
              "null"
            ],
            "format": "email"
          },
          "password": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "UpdateHostRequest": {
        "type": "object",
        "description": "Request type for updating a host.\nOptionally includes interfaces and ports to sync (create/update/delete).",
        "required": [
          "id",
          "name",
          "hidden",
          "tags"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "expected_updated_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "Optional: expected updated_at timestamp for optimistic locking.\nIf provided, the update will fail with a conflict error if the host\nhas been modified since this timestamp (e.g., by discovery running\nwhile the user was editing)."
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "interfaces": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/components/schemas/UpdateInterfaceInput"
            },
            "description": "Optional: interfaces to sync with this host.\nIf provided, the server will:\n- Create interfaces without an `id` (or with nil UUID)\n- Keep/update interfaces with matching `id`\n- Delete existing interfaces not in this list\n\nIf not provided (None), interfaces are left unchanged."
          },
          "name": {
            "type": "string"
          },
          "ports": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/components/schemas/UpdatePortInput"
            },
            "description": "Optional: ports to sync with this host.\nIf provided, the server will:\n- Create ports without an `id` (or with nil UUID)\n- Keep/update ports with matching `id`\n- Delete existing ports not in this list\n\nIf not provided (None), ports are left unchanged."
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        }
      },
      "UpdateInterfaceInput": {
        "type": "object",
        "description": "Input for syncing an interface during host update.\nIf `id` is None or nil UUID, a new interface is created.\nIf `id` matches an existing interface, it is updated.",
        "required": [
          "subnet_id",
          "ip_address"
        ],
        "properties": {
          "id": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid",
            "description": "ID of existing interface to update, or None/nil for new interface"
          },
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "position": {
            "type": "integer",
            "format": "int32",
            "description": "Position of this interface in the host's interface list (for ordering)"
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "UpdatePortInput": {
        "type": "object",
        "description": "Input for syncing a port during host update.\nIf `id` is None or nil UUID, a new port is created.\nIf `id` matches an existing port, it is kept.",
        "required": [
          "number",
          "protocol"
        ],
        "properties": {
          "id": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid",
            "description": "ID of existing port to keep, or None/nil for new port"
          },
          "number": {
            "type": "integer",
            "format": "int32",
            "description": "Port number (1-65535)",
            "minimum": 0
          },
          "protocol": {
            "$ref": "#/components/schemas/TransportProtocol",
            "description": "Transport protocol (Tcp or Udp)"
          }
        }
      },
      "User": {
        "allOf": [
          {
            "$ref": "#/components/schemas/UserBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "UserBase": {
        "type": "object",
        "required": [
          "email",
          "organization_id",
          "permissions",
          "network_ids"
        ],
        "properties": {
          "email": {
            "type": "string"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "oidc_linked_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "oidc_provider": {
            "type": [
              "string",
              "null"
            ]
          },
          "oidc_subject": {
            "type": [
              "string",
              "null"
            ]
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "terms_accepted_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "readOnly": true
          }
        }
      },
      "UserOrgPermissions": {
        "type": "string",
        "enum": [
          "Owner",
          "Admin",
          "Member",
          "Viewer"
        ]
      },
      "Uxy": {
        "type": "object",
        "required": [
          "x",
          "y"
        ],
        "properties": {
          "x": {
            "type": "integer",
            "minimum": 0
          },
          "y": {
            "type": "integer",
            "minimum": 0
          }
        }
      }
    },
    "securitySchemes": {
      "api_key": {
        "type": "apiKey",
        "in": "header",
        "name": "Authorization: Bearer",
        "description": "API key for daemon authentication. Generate keys in the web UI under Settings > API Keys."
      },
      "session_id": {
        "type": "apiKey",
        "in": "cookie",
        "name": "session_id"
      }
    }
  },
  "tags": [
    {
      "name": "api_keys",
      "description": "API keys for daemon authentication. Create and manage keys that allow daemons to communicate with the server."
    },
    {
      "name": "auth",
      "description": "Authentication and session management. Handle user login, logout, and session state."
    },
    {
      "name": "config",
      "description": "Server configuration. Public configuration settings for client applications."
    },
    {
      "name": "discoveries",
      "description": "Network discovery operations. Trigger and monitor scans that detect hosts, services, and network topology."
    },
    {
      "name": "github",
      "description": "GitHub integration endpoints."
    },
    {
      "name": "ports",
      "description": "Ports that have been scanned and found open on a host"
    },
    {
      "name": "bindings",
      "description": "\n            ## Binding Types\n            - **Interface binding**: Service is present at an interface (IP address) without a specific port.\n              Used for non-port-bound services like gateways.\n            - **Port binding (specific interface)**: Service listens on a specific port on a specific interface.\n            - **Port binding (all interfaces)**: Service listens on a specific port on all interfaces\n              (`interface_id: null`).\n\n            ## Validation and Deduplication Rules\n            - **Conflict detection**: Interface bindings conflict with port bindings on the same interface.\n              A port binding on all interfaces conflicts with any interface binding for the same service.\n            - **All-interfaces precedence**: When creating a port binding with `interface_id: null`,\n              any existing specific-interface bindings for the same port are automatically removed,\n              as they are superseded by the all-interfaces binding.\n        "
    },
    {
      "name": "groups",
      "description": "Logical groupings of hosts. Organize hosts into groups for easier management and visualization."
    },
    {
      "name": "hosts",
      "description": "Network hosts (devices). Manage discovered or manually created hosts on your network."
    },
    {
      "name": "interfaces",
      "description": "Network interfaces on hosts. Each host can have multiple interfaces with different IP addresses."
    },
    {
      "name": "invites",
      "description": "Organization invitations. Invite users to join your organization."
    },
    {
      "name": "metadata",
      "description": "Entity metadata registry. Schema information for all entity types in the system."
    },
    {
      "name": "networks",
      "description": "Network containers. Top-level organizational unit that contains subnets, hosts, and other entities."
    },
    {
      "name": "organizations",
      "description": "Manage organization settings."
    },
    {
      "name": "services",
      "description": "Services running on hosts. Detected or manually added services like databases, web servers, etc."
    },
    {
      "name": "shares",
      "description": "Shared network views. Create read-only shareable links to your network topology."
    },
    {
      "name": "subnets",
      "description": "IP subnets within networks. Define address ranges and organize hosts by subnet."
    },
    {
      "name": "tags",
      "description": "Custom tags for categorization. Apply labels to entities for filtering and organization."
    },
    {
      "name": "users",
      "description": "User account management. Manage user profiles and permissions within organizations."
    }
  ]
}