{
  "openapi": "3.1.0",
  "info": {
    "title": "Scanopy API",
    "description": "\nNetwork topology discovery and visualization API.\n\n## Authentication\n\nTwo authentication methods are supported:\n\n| Method | Header | Use Case |\n|--------|--------|----------|\n| User API key | `Authorization: Bearer scp_u_...` | Programmatic access, integrations |\n| Session cookie | `Cookie: session_id=...` | Web UI (via `/api/auth/login`) |\n\nUser API keys require your organization to have API access enabled. Create keys at **Platform > API Keys**.\n\n## Rate Limiting\n\nLimit: 300 requests/minute\n\nBurst: 150\n\nResponse headers: `X-RateLimit-Limit`, `X-RateLimit-Remaining`, `X-RateLimit-Reset`\n\nWhen rate limited, you'll receive HTTP `429 Too Many Requests` with a `Retry-After` header.\n\n## Response Format\n\nAll responses use a standard envelope:\n\n```json\n{\n  \"success\": true,\n  \"data\": { ... },\n  \"meta\": {\n    \"api_version\": 1,\n    \"server_version\": \"0.12.10\"\n  }\n}\n```\n\nError responses include an `error` field instead of `data`:\n\n```json\n{\n  \"success\": false,\n  \"error\": \"Resource not found\",\n  \"meta\": { ... }\n}\n```\n\n**Common status codes:** `400` validation error, `401` unauthorized, `403` forbidden, `404` not found, `409` conflict, `429` rate limited.\n\n## Versioning\n\nThe API version is an integer (`api_version: 1`) incremented only on breaking changes. API is versioned independently from the application. Endpoints are prefixed with `/api/v1/`. Check `GET /api/version` for current versions.\n\n## Multi-Tenancy\n\nResources are scoped to your **organization** and **network(s)**:\n\n- You can only access entities within your organization\n- Network-level entities (hosts, services, etc.) are filtered to networks you have access to\n- Use `?network_id=<UUID>` to filter list endpoints to a specific network\n- API keys can be scoped to a subset of your accessible networks\n",
    "license": {
      "name": "Dual (AGPL3.0, Commercial License Available)"
    },
    "version": "1"
  },
  "paths": {
    "/api/v1/auth/daemon": {
      "get": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "List all daemon_api_keys",
        "operationId": "list_daemon_api_keys",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of daemon_api_keys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_DaemonApiKey"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "Create daemon API key",
        "operationId": "create_daemon_api_key",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DaemonApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Daemon API key created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_DaemonApiKeyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Insufficient permissions (member+ required)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/daemon/bulk-delete": {
      "post": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "Bulk delete daemon_api_keys",
        "operationId": "bulk_delete_daemon_api_keys",
        "requestBody": {
          "description": "Array of daemon_api_keys IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "DaemonApiKeys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/daemon/{id}": {
      "get": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "Get daemon_api_key by ID",
        "operationId": "get_daemon_api_key_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "DaemonApiKey ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "DaemonApiKey found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_DaemonApiKey"
                }
              }
            }
          },
          "404": {
            "description": "DaemonApiKey not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "Update a daemon API key",
        "operationId": "update_daemon_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DaemonApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Daemon API key updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_DaemonApiKey"
                }
              }
            }
          },
          "404": {
            "description": "Daemon API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "Delete daemon_api_key",
        "operationId": "delete_daemon_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "DaemonApiKey ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "DaemonApiKey deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "DaemonApiKey not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/daemon/{id}/rotate": {
      "post": {
        "tags": [
          "daemon_api_keys"
        ],
        "summary": "Rotate a daemon API key",
        "operationId": "rotate_key_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon API key rotated, returns new key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_String"
                }
              }
            }
          },
          "404": {
            "description": "Daemon API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/keys": {
      "get": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Get all user API keys for the current user",
        "operationId": "get_all_user_api_keys",
        "parameters": [
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of user API keys",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_UserApiKey"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Create a new user API key",
        "operationId": "create_user_api_key",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API key created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_UserApiKeyResponse"
                }
              }
            }
          },
          "400": {
            "description": "Bad request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Invalid permissions or network access",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/keys/bulk-delete": {
      "post": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Bulk delete user API keys",
        "operationId": "bulk_delete_user_api_keys",
        "requestBody": {
          "description": "Array of API key IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API keys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/keys/{id}": {
      "get": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Get a user API key by ID",
        "operationId": "get_user_api_key_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "API key found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_UserApiKey"
                }
              }
            }
          },
          "404": {
            "description": "API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Update a user API key",
        "operationId": "update_user_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API key updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_UserApiKey"
                }
              }
            }
          },
          "403": {
            "description": "Not authorized to update this key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Delete a user API key",
        "operationId": "delete_user_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "API key deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/auth/keys/{id}/rotate": {
      "post": {
        "tags": [
          "user_api_keys"
        ],
        "summary": "Rotate a user API key",
        "operationId": "rotate_user_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "API key rotated, returns new key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_String"
                }
              }
            }
          },
          "403": {
            "description": "Not authorized to rotate this key",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "API key not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/bindings": {
      "get": {
        "tags": [
          "bindings"
        ],
        "summary": "List all bindings",
        "operationId": "list_bindings",
        "parameters": [
          {
            "name": "service_id",
            "in": "query",
            "description": "Filter by service ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "port_id",
            "in": "query",
            "description": "Filter by port ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "interface_id",
            "in": "query",
            "description": "Filter by interface ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of bindings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Binding"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "bindings"
        ],
        "summary": "Create a new binding",
        "description": "Creates a binding that associates a service with a port or interface.\n\n### Binding Types\n\n- **Interface binding**: Service is present at an interface (IP address) without a specific port.\n  Used for non-port-bound services like gateways.\n- **Port binding (specific interface)**: Service listens on a specific port on a specific interface.\n- **Port binding (all interfaces)**: Service listens on a specific port on all interfaces\n  (`interface_id: null`).\n\n### Validation and Deduplication Rules\n\n- **Conflict detection**: Interface bindings conflict with port bindings on the same interface.\n  A port binding on all interfaces conflicts with any interface binding for the same service.\n- **All-interfaces precedence**: When creating a port binding with `interface_id: null`,\n  any existing specific-interface bindings for the same port are automatically removed,\n  as they are superseded by the all-interfaces binding.",
        "operationId": "create_binding",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Binding"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Binding created (superseded bindings may be removed)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Binding"
                }
              }
            }
          },
          "400": {
            "description": "Referenced port or interface does not exist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict with existing binding type",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/bindings/bulk-delete": {
      "post": {
        "tags": [
          "bindings"
        ],
        "summary": "Bulk delete bindings",
        "operationId": "bulk_delete_bindings",
        "requestBody": {
          "description": "Array of bindings IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bindings deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/bindings/{id}": {
      "get": {
        "tags": [
          "bindings"
        ],
        "summary": "Get binding by ID",
        "operationId": "get_binding_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Binding found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Binding"
                }
              }
            }
          },
          "404": {
            "description": "Binding not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "bindings"
        ],
        "summary": "Update a binding",
        "description": "Updates an existing binding. The same conflict detection rules from binding creation apply.\n\n## Validation Rules\n\n- **Conflict detection**: The updated binding must not conflict with other bindings on the\n  same service. Interface bindings conflict with port bindings on the same interface.",
        "operationId": "update_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Binding"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Binding updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Binding"
                }
              }
            }
          },
          "400": {
            "description": "Referenced port or interface does not exist",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict with existing binding type",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "bindings"
        ],
        "summary": "Delete binding",
        "operationId": "delete_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Binding deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Binding not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/daemons": {
      "get": {
        "tags": [
          "daemons"
        ],
        "summary": "Get all daemons",
        "description": "Returns all daemons accessible to the user with computed version status.",
        "operationId": "get_daemons",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of daemons",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_DaemonResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/daemons/bulk-delete": {
      "post": {
        "tags": [
          "daemons"
        ],
        "summary": "Bulk delete daemons",
        "operationId": "bulk_delete_daemons",
        "requestBody": {
          "description": "Array of daemons IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Daemons deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/daemons/{id}": {
      "get": {
        "tags": [
          "daemons"
        ],
        "summary": "Get daemon by ID",
        "description": "Returns a specific daemon with computed version status.",
        "operationId": "get_daemon_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_DaemonResponse"
                }
              }
            }
          },
          "403": {
            "description": "Access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Daemon not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "daemons"
        ],
        "summary": "Delete daemon",
        "operationId": "delete_daemon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Daemon not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/discovery": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "List all discoveries",
        "operationId": "list_discoveries",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "daemon_id",
            "in": "query",
            "description": "Filter by daemon ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of discoveries",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Discovery"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Create new discovery",
        "operationId": "create_discovery",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Discovery"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Discovery"
                }
              }
            }
          },
          "400": {
            "description": "Can't create historical discovery",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/discovery/active-sessions": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "Get active discovery sessions",
        "operationId": "get_active_sessions",
        "responses": {
          "200": {
            "description": "List of active discovery sessions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_DiscoveryUpdatePayload"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/discovery/bulk-delete": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Bulk delete discoveries",
        "operationId": "bulk_delete_discoveries",
        "requestBody": {
          "description": "Array of discoveries IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discoverys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/discovery/start-session": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Start a discovery session",
        "operationId": "start_session",
        "requestBody": {
          "content": {
            "text/plain": {
              "schema": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery session started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_DiscoveryUpdatePayload"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/discovery/{id}": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "Get discovery by ID",
        "operationId": "get_discovery_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Discovery"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "discoveries"
        ],
        "summary": "Update discovery",
        "operationId": "update_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Discovery"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Discovery"
                }
              }
            }
          },
          "400": {
            "description": "Can't update historical discovery",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "discoveries"
        ],
        "summary": "Delete discovery",
        "operationId": "delete_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/discovery/{session_id}/cancel": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Cancel a discovery session",
        "operationId": "cancel_discovery",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "description": "Session ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery session cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/groups": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "List all groups",
        "operationId": "list_groups",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of groups",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Group"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Create a new group",
        "operationId": "create_group",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Group"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Group"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/groups/bulk-delete": {
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Bulk delete groups",
        "operationId": "bulk_delete_groups",
        "requestBody": {
          "description": "Array of groups IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Groups deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/groups/{id}": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "Get group by ID",
        "operationId": "get_group_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Group"
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "groups"
        ],
        "summary": "Update a group",
        "operationId": "update_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Group"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Group"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "groups"
        ],
        "summary": "Delete group",
        "operationId": "delete_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/hosts": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "List all hosts",
        "description": "Returns all hosts the authenticated user has access to, with their\ninterfaces, ports, and services included. Supports pagination via\n`limit` and `offset` query parameters.",
        "operationId": "get_all_hosts",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of hosts with their children",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_HostResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Create a new host",
        "description": "Creates a host with optional interfaces, ports, and services.\nThe `source` field is automatically set to `Manual`.\n\n### Tag Validation\n\n- Tags must exist and belong to your organization\n- Duplicate tag UUIDs are automatically deduplicated\n- Invalid or cross-organization tag UUIDs return a 400 error\n\n",
        "operationId": "create_host",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Host created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: network not found, subnet mismatch, or invalid tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "No access to the specified network",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          },
          {
            "daemon_api_key": []
          }
        ]
      }
    },
    "/api/v1/hosts/bulk-delete": {
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Bulk delete hosts",
        "description": "Deletes multiple hosts in a single request. The request body should be\nan array of host IDs to delete. Fails if any host has an associated daemon.",
        "operationId": "bulk_delete_hosts",
        "requestBody": {
          "description": "Array of host IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Hosts deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "409": {
            "description": "One or more hosts has an associated daemon - delete daemons first",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/hosts/{destination_host}/consolidate/{other_host}": {
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Consolidate hosts",
        "description": "Merges all interfaces, ports, and services from `other_host` into\n`destination_host`, then deletes `other_host`. Both hosts must be\non the same network.\n\n### Merge Behavior\n\n- **Interfaces**: Transferred to destination. If an interface with matching subnet+IP or MAC\n  already exists on destination, bindings are remapped to use the existing interface.\n- **Ports**: Transferred to destination. If a port with the same number and protocol already\n  exists, bindings are remapped to use the existing port.\n- **Services**: Transferred to destination with deduplication.\n  See [upsert behavior](https://scanopy.net/docs/discovery/#upsert-behavior) for details.\n\n### Restrictions\n\n- Cannot consolidate a host with itself.\n- Cannot consolidate a host that has a daemon - consolidate into it instead.",
        "operationId": "consolidate_hosts",
        "parameters": [
          {
            "name": "destination_host",
            "in": "path",
            "description": "Destination host ID - will receive all children",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "other_host",
            "in": "path",
            "description": "Host to merge into destination - will be deleted",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Hosts consolidated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: same host, has daemon, or different networks",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "One or both hosts not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/hosts/{id}": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "Get a host by ID",
        "description": "Returns a single host with its interfaces, ports, and services.",
        "operationId": "get_host_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Host found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Update a host",
        "description": "Updates host properties. Children (interfaces, ports, services)\nare managed via their own endpoints.\n\n### Tag Validation\n\n- Tags must exist and belong to your organization\n- Duplicate tag UUIDs are automatically deduplicated\n- Invalid or cross-organization tag UUIDs return a 400 error",
        "operationId": "update_host",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Host updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: invalid tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "hosts"
        ],
        "summary": "Delete a host",
        "description": "Prevents deletion if the host has a daemon associated with it",
        "operationId": "delete_host",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Host deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Host has associated daemon",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/interfaces": {
      "get": {
        "tags": [
          "interfaces"
        ],
        "summary": "List all interfaces",
        "operationId": "list_interfaces",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "subnet_id",
            "in": "query",
            "description": "Filter by subnet ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of interfaces",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Interface"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "interfaces"
        ],
        "summary": "Create a new interface\nPosition is automatically assigned to the end of the host's interface list.",
        "operationId": "create_interface",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Interface"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interface created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Interface"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/interfaces/bulk-delete": {
      "post": {
        "tags": [
          "interfaces"
        ],
        "summary": "Bulk delete interfaces\nRemaining interfaces for affected hosts are renumbered to maintain sequential positions.",
        "operationId": "bulk_delete_interfaces",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interfaces deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "400": {
            "description": "No IDs provided",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/interfaces/{id}": {
      "get": {
        "tags": [
          "interfaces"
        ],
        "summary": "Get interface by ID",
        "operationId": "get_interface_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Interface found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Interface"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "interfaces"
        ],
        "summary": "Update an interface\nPosition must be within valid range and not conflict with other interfaces.",
        "operationId": "update_interface",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Interface"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interface updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Interface"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "interfaces"
        ],
        "summary": "Delete an interface\nRemaining interfaces for the host are renumbered to maintain sequential positions.",
        "operationId": "delete_interface",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Interface deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/invites": {
      "get": {
        "tags": [
          "invites"
        ],
        "summary": "List all invites",
        "operationId": "get_invites",
        "responses": {
          "200": {
            "description": "List of active invites",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Invite"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "invites"
        ],
        "summary": "Create invite",
        "operationId": "create_invite",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateInviteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Invite created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Invite"
                }
              }
            }
          },
          "403": {
            "description": "Cannot create invite with higher permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/invites/{id}": {
      "get": {
        "tags": [
          "invites"
        ],
        "summary": "Get an invite by ID",
        "operationId": "get_invite",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Invite ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Invite details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Invite"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired invite",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/invites/{id}/revoke": {
      "delete": {
        "tags": [
          "invites"
        ],
        "summary": "Revoke an invite",
        "operationId": "revoke_invite",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Invite ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Invite revoked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid invite",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot revoke this invite",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/networks": {
      "get": {
        "tags": [
          "networks"
        ],
        "summary": "List all networks",
        "operationId": "list_networks",
        "parameters": [
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of networks",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Network"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "networks"
        ],
        "summary": "Create a new network",
        "operationId": "create_network",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Network"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Network created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Network"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/networks/bulk-delete": {
      "post": {
        "tags": [
          "networks"
        ],
        "summary": "Bulk delete networks",
        "operationId": "bulk_delete_networks",
        "requestBody": {
          "description": "Array of network IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Networks deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "403": {
            "description": "User not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/networks/{id}": {
      "get": {
        "tags": [
          "networks"
        ],
        "summary": "Get network by ID",
        "operationId": "get_network_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Network found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Network"
                }
              }
            }
          },
          "404": {
            "description": "Network not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "networks"
        ],
        "summary": "Update a network",
        "operationId": "update_network",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Network"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Network updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Network"
                }
              }
            }
          },
          "403": {
            "description": "User not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Network not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "networks"
        ],
        "summary": "Delete a network",
        "operationId": "delete_network",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Network deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "403": {
            "description": "User not admin",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Network not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/organizations": {
      "get": {
        "tags": [
          "organizations"
        ],
        "summary": "Get the current user's organization",
        "operationId": "get_organization",
        "responses": {
          "200": {
            "description": "Organization details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Organization"
                }
              }
            }
          },
          "404": {
            "description": "Organization not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/organizations/{id}": {
      "put": {
        "tags": [
          "organizations"
        ],
        "summary": "Update organization name",
        "operationId": "update_org_name",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Organization ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "text/plain": {
              "schema": {
                "type": "string"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Organization updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Organization"
                }
              }
            }
          },
          "403": {
            "description": "Only owners can update organization",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Organization not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/ports": {
      "get": {
        "tags": [
          "ports"
        ],
        "summary": "List all ports",
        "operationId": "list_ports",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of ports",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Port"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "ports"
        ],
        "summary": "Create a new port",
        "operationId": "create_port",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Port"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Port created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Port"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or duplicate port",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/ports/bulk-delete": {
      "post": {
        "tags": [
          "ports"
        ],
        "summary": "Bulk delete ports",
        "operationId": "bulk_delete_ports",
        "requestBody": {
          "description": "Array of ports IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ports deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/ports/{id}": {
      "get": {
        "tags": [
          "ports"
        ],
        "summary": "Get port by ID",
        "operationId": "get_port_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Port found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Port"
                }
              }
            }
          },
          "404": {
            "description": "Port not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "ports"
        ],
        "summary": "Update a port",
        "operationId": "update_port",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Port"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Port updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Port"
                }
              }
            }
          },
          "400": {
            "description": "Network mismatch or invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Port not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "ports"
        ],
        "summary": "Delete port",
        "operationId": "delete_port",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Port deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Port not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/services": {
      "get": {
        "tags": [
          "services"
        ],
        "summary": "List all services",
        "operationId": "list_services",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of services",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Service"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "services"
        ],
        "summary": "Create a new service",
        "description": "Creates a service with optional bindings to interfaces or ports.\nThe `id`, `created_at`, `updated_at`, and `source` fields are generated server-side.\nBindings are specified without `service_id` or `network_id` - these are assigned automatically.\n\n### Binding Validation Rules\n\n- **Cross-host validation**: All bindings must reference ports/interfaces that belong to the\n  service's host. Bindings referencing entities from other hosts will be rejected.\n- **Deduplication**: Duplicate bindings in the same request are automatically deduplicated.\n- **All-interfaces precedence**: If a port binding with `interface_id: null` (all interfaces)\n  is included, any specific-interface bindings for the same port are automatically removed.\n- **Conflict detection**: Interface bindings conflict with port bindings on the same interface.\n  A port binding on all interfaces conflicts with any interface binding.",
        "operationId": "create_service",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateServiceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Service"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: host network mismatch, cross-host binding, or binding conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/services/bulk-delete": {
      "post": {
        "tags": [
          "services"
        ],
        "summary": "Bulk delete services",
        "operationId": "bulk_delete_services",
        "requestBody": {
          "description": "Array of services IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Services deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/services/{id}": {
      "get": {
        "tags": [
          "services"
        ],
        "summary": "Get service by ID",
        "operationId": "get_service_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Service"
                }
              }
            }
          },
          "404": {
            "description": "Service not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "services"
        ],
        "summary": "Update a service",
        "description": "Updates an existing service. All binding validation rules from service creation apply here as well.\n\n## Binding Validation Rules\n\n- **Cross-host validation**: All bindings must reference ports/interfaces that belong to the\n  service's host. Bindings referencing entities from other hosts will be rejected.\n- **Deduplication**: Duplicate bindings are automatically deduplicated.\n- **All-interfaces precedence**: If a port binding with `interface_id: null` (all interfaces)\n  is included, any specific-interface bindings for the same port are automatically removed.\n- **Conflict detection**: Interface bindings conflict with port bindings on the same interface.",
        "operationId": "update_service",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Service"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Service"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: host network mismatch, cross-host binding, or binding conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Service not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "services"
        ],
        "summary": "Delete service",
        "operationId": "delete_service",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Service not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/shares": {
      "get": {
        "tags": [
          "shares"
        ],
        "summary": "List all shares",
        "operationId": "list_shares",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "topology_id",
            "in": "query",
            "description": "Filter by topology ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of shares",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Share"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "shares"
        ],
        "summary": "Create a new share",
        "operationId": "create_share",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUpdateShareRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Share created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Share"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/shares/bulk-delete": {
      "post": {
        "tags": [
          "shares"
        ],
        "summary": "Bulk delete shares",
        "operationId": "bulk_delete_shares",
        "requestBody": {
          "description": "Array of shares IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Shares deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/shares/public/{id}": {
      "get": {
        "tags": [
          "shares"
        ],
        "summary": "Get share metadata",
        "description": "Does not include any topology data",
        "operationId": "get_public_share_metadata",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Share metadata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_PublicShareMetadata"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/shares/{id}": {
      "get": {
        "tags": [
          "shares"
        ],
        "summary": "Get share by ID",
        "operationId": "get_share_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Share found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Share"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "shares"
        ],
        "summary": "Update a share",
        "operationId": "update_share",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUpdateShareRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Share updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Share"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "shares"
        ],
        "summary": "Delete share",
        "operationId": "delete_share",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Share ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Share deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Share not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/subnets": {
      "get": {
        "tags": [
          "subnets"
        ],
        "summary": "List all subnets",
        "description": "Returns all subnets accessible to the authenticated user or daemon.\nDaemons can only access subnets within their assigned network.",
        "operationId": "list_subnets",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of subnets",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Subnet"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          },
          {
            "daemon_api_key": []
          }
        ]
      },
      "post": {
        "tags": [
          "subnets"
        ],
        "summary": "Create a new subnet",
        "operationId": "create_subnet",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Subnet"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnet created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Subnet"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          },
          {
            "daemon_api_key": []
          }
        ]
      }
    },
    "/api/v1/subnets/bulk-delete": {
      "post": {
        "tags": [
          "subnets"
        ],
        "summary": "Bulk delete subnets",
        "operationId": "bulk_delete_subnets",
        "requestBody": {
          "description": "Array of subnets IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnets deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/subnets/{id}": {
      "get": {
        "tags": [
          "subnets"
        ],
        "summary": "Get subnet by ID",
        "operationId": "get_subnet_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subnet found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Subnet"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "subnets"
        ],
        "summary": "Update a subnet",
        "description": "Updates subnet properties. If the CIDR is being changed, validates that\nall existing interfaces on this subnet have IPs within the new CIDR range.",
        "operationId": "update_subnet",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Subnet"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnet updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Subnet"
                }
              }
            }
          },
          "400": {
            "description": "CIDR change would orphan existing interfaces",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "subnets"
        ],
        "summary": "Delete subnet",
        "operationId": "delete_subnet",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subnet deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/tags": {
      "get": {
        "tags": [
          "tags"
        ],
        "summary": "List all tags",
        "operationId": "list_tags",
        "parameters": [
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_Tag"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "tags"
        ],
        "summary": "Create a new tag",
        "description": "Creates a tag scoped to your organization. Tag names must be unique within the organization.\n\n### Validation\n\n- Name must be 1-100 characters (empty names are rejected)\n- Name must be unique within your organization",
        "operationId": "create_tag",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Tag"
                }
              }
            }
          },
          "400": {
            "description": "Validation error: name empty or too long",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Tag name already exists in this organization",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/tags/bulk-delete": {
      "post": {
        "tags": [
          "tags"
        ],
        "summary": "Bulk delete tags",
        "operationId": "bulk_delete_tags",
        "requestBody": {
          "description": "Array of tags IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tags deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/tags/{id}": {
      "get": {
        "tags": [
          "tags"
        ],
        "summary": "Get tag by ID",
        "operationId": "get_tag_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Tag"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "tags"
        ],
        "summary": "Update tag",
        "operationId": "update_tag",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Tag"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "tags"
        ],
        "summary": "Delete tag",
        "operationId": "delete_tag",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/topology/{id}/lock": {
      "post": {
        "tags": [
          "topology"
        ],
        "summary": "Lock a topology",
        "operationId": "lock",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Topology ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Topology locked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Topology"
                }
              }
            }
          },
          "403": {
            "description": "Access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Topology not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/topology/{id}/unlock": {
      "post": {
        "tags": [
          "topology"
        ],
        "summary": "Unlock a topology",
        "operationId": "unlock",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Topology ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Topology unlocked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Topology"
                }
              }
            }
          },
          "403": {
            "description": "Access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Topology not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/users": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "List all users",
        "operationId": "get_all_users",
        "parameters": [
          {
            "name": "pagination",
            "in": "query",
            "description": "Pagination parameters",
            "required": false,
            "schema": {
              "oneOf": [
                {
                  "type": "null"
                },
                {
                  "$ref": "#/components/schemas/PaginationParams"
                }
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_Vec_User"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/v1/users/bulk-delete": {
      "post": {
        "tags": [
          "users"
        ],
        "summary": "Bulk delete users",
        "operationId": "bulk_delete_users",
        "requestBody": {
          "description": "Array of user IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Users deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_BulkDeleteResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot delete users with higher permissions",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "user_api_key": []
          },
          {
            "session": []
          }
        ]
      }
    },
    "/api/version": {
      "get": {
        "tags": [
          "system"
        ],
        "summary": "Get API version information",
        "operationId": "get_version",
        "responses": {
          "200": {
            "description": "Version information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse_VersionInfo"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ApiErrorResponse": {
        "type": "object",
        "description": "Error response type for API errors (no data field)",
        "required": [
          "success"
        ],
        "properties": {
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiMeta": {
        "type": "object",
        "description": "API version metadata included in all responses",
        "required": [
          "api_version",
          "server_version"
        ],
        "properties": {
          "api_version": {
            "type": "integer",
            "format": "int32",
            "description": "API version (integer, increments on breaking changes)",
            "minimum": 0
          },
          "pagination": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/PaginationMeta",
                "description": "Pagination info (only present for paginated list responses)"
              }
            ]
          },
          "server_version": {
            "type": "string",
            "description": "Server version (semver)",
            "example": "0.12.10"
          }
        }
      },
      "ApiResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/TupleUnit"
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Binding": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/BindingBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "description": "Association between a service and a port / interface that the service is listening on",
            "example": {
<<<<<<< HEAD
              "created_at": "2026-01-06T20:35:46.470840Z",
              "id": "618f7060-66df-497b-a335-e68c76f2d288",
=======
              "created_at": "2026-01-06T18:14:22.479974Z",
              "id": "ed14265a-40e5-4a38-8acb-aba7f2eb69d2",
>>>>>>> fix/discovery-duplicates
              "interface_id": "550e8400-e29b-41d4-a716-446655440005",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "port_id": "550e8400-e29b-41d4-a716-446655440006",
              "service_id": "550e8400-e29b-41d4-a716-446655440007",
              "type": "Port",
<<<<<<< HEAD
              "updated_at": "2026-01-06T20:35:46.470840Z"
=======
              "updated_at": "2026-01-06T18:14:22.479974Z"
>>>>>>> fix/discovery-duplicates
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_BulkDeleteResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "deleted_count",
              "requested_count"
            ],
            "properties": {
              "deleted_count": {
                "type": "integer",
                "minimum": 0
              },
              "requested_count": {
                "type": "integer",
                "minimum": 0
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonApiKey": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DaemonApiKeyBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "updated_at",
                  "created_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonApiKeyResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "api_key",
              "key"
            ],
            "properties": {
              "api_key": {
                "$ref": "#/components/schemas/DaemonApiKey"
              },
              "key": {
                "type": "string"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonRegistrationResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Daemon registration response from server to daemon",
            "required": [
              "daemon",
              "host_id"
            ],
            "properties": {
              "daemon": {
                "$ref": "#/components/schemas/Daemon"
              },
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "server_capabilities": {
                "oneOf": [
                  {
                    "type": "null"
                  },
                  {
                    "$ref": "#/components/schemas/ServerCapabilities",
                    "description": "Server capabilities (returned if daemon sends version info)"
                  }
                ]
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DaemonBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at",
                  "version_status"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "version_status": {
                    "$ref": "#/components/schemas/DaemonVersionStatus",
                    "description": "Computed version status including health and warnings"
                  }
                }
              }
            ],
            "description": "Daemon response for UI including computed version status"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DaemonSetupResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response from daemon setup endpoint",
            "properties": {
              "api_key": {
                "type": [
                  "string",
                  "null"
                ]
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Discovery": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/DiscoveryBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_DiscoveryUpdatePayload": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Progress update from daemon to server during discovery",
            "required": [
              "session_id",
              "daemon_id",
              "network_id",
              "phase",
              "discovery_type",
              "progress"
            ],
            "properties": {
              "daemon_id": {
                "type": "string",
                "format": "uuid"
              },
              "discovery_type": {
                "$ref": "#/components/schemas/DiscoveryType"
              },
              "error": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "finished_at": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "phase": {
                "$ref": "#/components/schemas/DiscoveryPhase"
              },
              "progress": {
                "type": "integer",
                "format": "int32",
                "minimum": 0
              },
              "session_id": {
                "type": "string",
                "format": "uuid"
              },
              "started_at": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Group": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/GroupBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "binding_ids": [],
              "color": "Blue",
              "created_at": "2026-01-15T10:30:00Z",
              "description": "HTTP/HTTPS services group",
              "edge_style": "Bezier",
              "group_type": "RequestPath",
              "id": "550e8400-e29b-41d4-a716-446655440008",
              "name": "Web Services",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "source": {
                "type": "Manual"
              },
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_HostResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
            "required": [
              "id",
              "created_at",
              "updated_at",
              "name",
              "network_id",
              "source",
              "hidden",
              "tags",
              "interfaces",
              "ports",
              "services"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time"
              },
              "description": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "hidden": {
                "type": "boolean"
              },
              "hostname": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "interfaces": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Interface"
                }
              },
              "name": {
                "type": "string"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "ports": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Port"
                }
              },
              "services": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Service"
                }
              },
              "source": {
                "$ref": "#/components/schemas/EntitySource"
              },
              "tags": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "updated_at": {
                "type": "string",
                "format": "date-time"
              },
              "virtualization": {
                "oneOf": [
                  {
                    "type": "null"
                  },
                  {
                    "$ref": "#/components/schemas/HostVirtualization"
                  }
                ]
              }
            },
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "description": "Primary web server",
              "hidden": false,
              "hostname": "web-server-01.local",
              "id": "550e8400-e29b-41d4-a716-446655440003",
              "interfaces": [
                {
                  "created_at": "2026-01-15T10:30:00Z",
                  "host_id": "550e8400-e29b-41d4-a716-446655440003",
                  "id": "550e8400-e29b-41d4-a716-446655440005",
                  "ip_address": "192.168.1.100",
                  "mac_address": "DE:AD:BE:EF:12:34",
                  "name": "eth0",
                  "network_id": "550e8400-e29b-41d4-a716-446655440002",
                  "position": 0,
                  "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
                  "updated_at": "2026-01-15T10:30:00Z"
                }
              ],
              "name": "web-server-01",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "ports": [
                {
                  "created_at": "2026-01-15T10:30:00Z",
                  "host_id": "550e8400-e29b-41d4-a716-446655440003",
                  "id": "550e8400-e29b-41d4-a716-446655440006",
                  "network_id": "550e8400-e29b-41d4-a716-446655440002",
                  "number": 80,
                  "protocol": "Tcp",
                  "type": "Http",
                  "updated_at": "2026-01-15T10:30:00Z"
                }
              ],
              "services": [],
              "source": {
                "type": "Manual"
              },
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z",
              "virtualization": null
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Interface": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/InterfaceBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440005",
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "position": 0,
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Invite": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/InviteBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_MetadataRegistry": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "service_definitions",
              "subnet_types",
              "edge_types",
              "group_types",
              "entities",
              "ports",
              "discovery_types",
              "billing_plans",
              "features",
              "permissions",
              "concepts"
            ],
            "properties": {
              "billing_plans": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "concepts": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EntityMetadata"
                }
              },
              "discovery_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "edge_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "entities": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/EntityMetadata"
                }
              },
              "features": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "group_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "permissions": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "ports": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "service_definitions": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              },
              "subnet_types": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/TypeMetadata"
                }
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Network": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/NetworkBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "id": "550e8400-e29b-41d4-a716-446655440002",
              "name": "Home Network",
              "organization_id": "550e8400-e29b-41d4-a716-446655440001",
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Organization": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/OrganizationBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Port": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/PortBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "description": "Port entity with custom serialization that flattens PortType fields.",
            "example": {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440006",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "number": 80,
              "protocol": "Tcp",
              "type": "Http",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_PublicConfigResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "required": [
              "server_port",
              "disable_registration",
              "oidc_providers",
              "billing_enabled",
              "has_integrated_daemon",
              "has_email_service",
              "has_email_opt_in",
              "public_url",
              "needs_cookie_consent",
              "deployment_type"
            ],
            "properties": {
              "billing_enabled": {
                "type": "boolean"
              },
              "deployment_type": {
                "$ref": "#/components/schemas/DeploymentType"
              },
              "disable_registration": {
                "type": "boolean"
              },
              "has_email_opt_in": {
                "type": "boolean"
              },
              "has_email_service": {
                "type": "boolean"
              },
              "has_integrated_daemon": {
                "type": "boolean"
              },
              "needs_cookie_consent": {
                "type": "boolean"
              },
              "oidc_providers": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/OidcProviderMetadata"
                }
              },
              "plunk_key": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "posthog_key": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "public_url": {
                "type": "string"
              },
              "server_port": {
                "type": "integer",
                "format": "int32",
                "minimum": 0
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_PublicShareMetadata": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Public share metadata (returned without authentication)",
            "required": [
              "id",
              "name",
              "requires_password",
              "options"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "name": {
                "type": "string"
              },
              "options": {
                "$ref": "#/components/schemas/ShareOptions"
              },
              "requires_password": {
                "type": "boolean"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_ServerCapabilities": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Server capabilities returned on startup/registration",
            "required": [
              "server_version",
              "minimum_daemon_version"
            ],
            "properties": {
              "deprecation_warnings": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DeprecationWarning"
                },
                "description": "Deprecation warnings for the daemon"
              },
              "minimum_daemon_version": {
                "type": "string",
                "description": "Minimum daemon version supported by this server"
              },
              "server_version": {
                "type": "string",
                "description": "Server software version"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Service": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ServiceBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "bindings": [
                {
<<<<<<< HEAD
                  "created_at": "2026-01-06T20:35:46.466697Z",
                  "id": "4bb8834b-bf57-43b0-9581-fd59d132f6d5",
=======
                  "created_at": "2026-01-06T18:14:22.476823Z",
                  "id": "1bbffbb9-77ba-4f81-b4ff-eaaeb4d45163",
>>>>>>> fix/discovery-duplicates
                  "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                  "network_id": "550e8400-e29b-41d4-a716-446655440002",
                  "port_id": "550e8400-e29b-41d4-a716-446655440006",
                  "service_id": "550e8400-e29b-41d4-a716-446655440007",
                  "type": "Port",
<<<<<<< HEAD
                  "updated_at": "2026-01-06T20:35:46.466697Z"
=======
                  "updated_at": "2026-01-06T18:14:22.476823Z"
>>>>>>> fix/discovery-duplicates
                }
              ],
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440007",
              "name": "nginx",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "position": 0,
<<<<<<< HEAD
              "service_definition": "Confluence",
=======
              "service_definition": "Lidarr",
>>>>>>> fix/discovery-duplicates
              "source": {
                "type": "Manual"
              },
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z",
              "virtualization": null
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_SetupResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response from setup endpoint",
            "required": [
              "network_ids"
            ],
            "properties": {
              "network_ids": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Share": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/ShareBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_String": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "string"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Subnet": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/SubnetBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "cidr": "192.168.1.0/24",
              "created_at": "2026-01-15T10:30:00Z",
              "description": "Local area network",
              "id": "550e8400-e29b-41d4-a716-446655440004",
              "name": "LAN",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "source": {
                "type": "Manual"
              },
              "subnet_type": "Lan",
              "tags": [],
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Tag": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TagBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ],
            "example": {
              "color": "Green",
              "created_at": "2026-01-15T10:30:00Z",
              "description": "Production environment resources",
              "id": "550e8400-e29b-41d4-a716-44665544000a",
              "name": "production",
              "organization_id": "550e8400-e29b-41d4-a716-446655440001",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Topology": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/TopologyBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_User": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/UserBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "created_at",
                  "updated_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_UserApiKey": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "allOf": [
              {
                "$ref": "#/components/schemas/UserApiKeyBase"
              },
              {
                "type": "object",
                "required": [
                  "id",
                  "updated_at",
                  "created_at"
                ],
                "properties": {
                  "created_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  },
                  "id": {
                    "type": "string",
                    "format": "uuid",
                    "readOnly": true
                  },
                  "updated_at": {
                    "type": "string",
                    "format": "date-time",
                    "readOnly": true
                  }
                }
              }
            ]
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_UserApiKeyResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Response for user API key creation/rotation\nContains the full API key record plus the plaintext key (shown only once)",
            "required": [
              "api_key",
              "key"
            ],
            "properties": {
              "api_key": {
                "$ref": "#/components/schemas/UserApiKey"
              },
              "key": {
                "type": "string",
                "description": "The plaintext API key - only returned once during creation or rotation"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_BillingPlan": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Community"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Starter"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Pro"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Team"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Business"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Enterprise"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "Demo"
                          ]
                        }
                      }
                    }
                  ]
                },
                {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/PlanConfig"
                    },
                    {
                      "type": "object",
                      "required": [
                        "type"
                      ],
                      "properties": {
                        "type": {
                          "type": "string",
                          "enum": [
                            "CommercialSelfHosted"
                          ]
                        }
                      }
                    }
                  ]
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Binding": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/BindingBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "description": "Association between a service and a port / interface that the service is listening on",
              "example": {
<<<<<<< HEAD
                "created_at": "2026-01-06T20:35:46.470592Z",
                "id": "34b50230-3da3-458e-a8a5-462a504fb9cd",
=======
                "created_at": "2026-01-06T18:14:22.479723Z",
                "id": "34b546f6-ff56-4814-a02f-0ad003840636",
>>>>>>> fix/discovery-duplicates
                "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "port_id": "550e8400-e29b-41d4-a716-446655440006",
                "service_id": "550e8400-e29b-41d4-a716-446655440007",
                "type": "Port",
<<<<<<< HEAD
                "updated_at": "2026-01-06T20:35:46.470592Z"
=======
                "updated_at": "2026-01-06T18:14:22.479723Z"
>>>>>>> fix/discovery-duplicates
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_DaemonApiKey": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DaemonApiKeyBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "updated_at",
                    "created_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_DaemonResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DaemonBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at",
                    "version_status"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "version_status": {
                      "$ref": "#/components/schemas/DaemonVersionStatus",
                      "description": "Computed version status including health and warnings"
                    }
                  }
                }
              ],
              "description": "Daemon response for UI including computed version status"
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Discovery": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/DiscoveryBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_DiscoveryUpdatePayload": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "description": "Progress update from daemon to server during discovery",
              "required": [
                "session_id",
                "daemon_id",
                "network_id",
                "phase",
                "discovery_type",
                "progress"
              ],
              "properties": {
                "daemon_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "discovery_type": {
                  "$ref": "#/components/schemas/DiscoveryType"
                },
                "error": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "finished_at": {
                  "type": [
                    "string",
                    "null"
                  ],
                  "format": "date-time"
                },
                "network_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "phase": {
                  "$ref": "#/components/schemas/DiscoveryPhase"
                },
                "progress": {
                  "type": "integer",
                  "format": "int32",
                  "minimum": 0
                },
                "session_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "started_at": {
                  "type": [
                    "string",
                    "null"
                  ],
                  "format": "date-time"
                }
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Group": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/GroupBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "binding_ids": [],
                "color": "Blue",
                "created_at": "2026-01-15T10:30:00Z",
                "description": "HTTP/HTTPS services group",
                "edge_style": "Bezier",
                "group_type": "RequestPath",
                "id": "550e8400-e29b-41d4-a716-446655440008",
                "name": "Web Services",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "source": {
                  "type": "Manual"
                },
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_HostResponse": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
              "required": [
                "id",
                "created_at",
                "updated_at",
                "name",
                "network_id",
                "source",
                "hidden",
                "tags",
                "interfaces",
                "ports",
                "services"
              ],
              "properties": {
                "created_at": {
                  "type": "string",
                  "format": "date-time"
                },
                "description": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "hidden": {
                  "type": "boolean"
                },
                "hostname": {
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "id": {
                  "type": "string",
                  "format": "uuid"
                },
                "interfaces": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Interface"
                  }
                },
                "name": {
                  "type": "string"
                },
                "network_id": {
                  "type": "string",
                  "format": "uuid"
                },
                "ports": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Port"
                  }
                },
                "services": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Service"
                  }
                },
                "source": {
                  "$ref": "#/components/schemas/EntitySource"
                },
                "tags": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uuid"
                  }
                },
                "updated_at": {
                  "type": "string",
                  "format": "date-time"
                },
                "virtualization": {
                  "oneOf": [
                    {
                      "type": "null"
                    },
                    {
                      "$ref": "#/components/schemas/HostVirtualization"
                    }
                  ]
                }
              },
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "description": "Primary web server",
                "hidden": false,
                "hostname": "web-server-01.local",
                "id": "550e8400-e29b-41d4-a716-446655440003",
                "interfaces": [
                  {
                    "created_at": "2026-01-15T10:30:00Z",
                    "host_id": "550e8400-e29b-41d4-a716-446655440003",
                    "id": "550e8400-e29b-41d4-a716-446655440005",
                    "ip_address": "192.168.1.100",
                    "mac_address": "DE:AD:BE:EF:12:34",
                    "name": "eth0",
                    "network_id": "550e8400-e29b-41d4-a716-446655440002",
                    "position": 0,
                    "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
                    "updated_at": "2026-01-15T10:30:00Z"
                  }
                ],
                "name": "web-server-01",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "ports": [
                  {
                    "created_at": "2026-01-15T10:30:00Z",
                    "host_id": "550e8400-e29b-41d4-a716-446655440003",
                    "id": "550e8400-e29b-41d4-a716-446655440006",
                    "network_id": "550e8400-e29b-41d4-a716-446655440002",
                    "number": 80,
                    "protocol": "Tcp",
                    "type": "Http",
                    "updated_at": "2026-01-15T10:30:00Z"
                  }
                ],
                "services": [],
                "source": {
                  "type": "Manual"
                },
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z",
                "virtualization": null
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Interface": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/InterfaceBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "host_id": "550e8400-e29b-41d4-a716-446655440003",
                "id": "550e8400-e29b-41d4-a716-446655440005",
                "ip_address": "192.168.1.100",
                "mac_address": "DE:AD:BE:EF:12:34",
                "name": "eth0",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "position": 0,
                "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Invite": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/InviteBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Network": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/NetworkBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "id": "550e8400-e29b-41d4-a716-446655440002",
                "name": "Home Network",
                "organization_id": "550e8400-e29b-41d4-a716-446655440001",
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Port": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/PortBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "description": "Port entity with custom serialization that flattens PortType fields.",
              "example": {
                "created_at": "2026-01-15T10:30:00Z",
                "host_id": "550e8400-e29b-41d4-a716-446655440003",
                "id": "550e8400-e29b-41d4-a716-446655440006",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "number": 80,
                "protocol": "Tcp",
                "type": "Http",
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Service": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ServiceBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "bindings": [
                  {
<<<<<<< HEAD
                    "created_at": "2026-01-06T20:35:46.465607Z",
                    "id": "67bc286e-c75b-4c98-8dad-9953f2acfd30",
=======
                    "created_at": "2026-01-06T18:14:22.475933Z",
                    "id": "1af5b956-a6cc-4698-bf6e-5ef2c70a1314",
>>>>>>> fix/discovery-duplicates
                    "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                    "network_id": "550e8400-e29b-41d4-a716-446655440002",
                    "port_id": "550e8400-e29b-41d4-a716-446655440006",
                    "service_id": "550e8400-e29b-41d4-a716-446655440007",
                    "type": "Port",
<<<<<<< HEAD
                    "updated_at": "2026-01-06T20:35:46.465607Z"
=======
                    "updated_at": "2026-01-06T18:14:22.475933Z"
>>>>>>> fix/discovery-duplicates
                  }
                ],
                "created_at": "2026-01-15T10:30:00Z",
                "host_id": "550e8400-e29b-41d4-a716-446655440003",
                "id": "550e8400-e29b-41d4-a716-446655440007",
                "name": "nginx",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "position": 0,
<<<<<<< HEAD
                "service_definition": "Confluence",
=======
                "service_definition": "Lidarr",
>>>>>>> fix/discovery-duplicates
                "source": {
                  "type": "Manual"
                },
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z",
                "virtualization": null
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Share": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/ShareBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Subnet": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/SubnetBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "cidr": "192.168.1.0/24",
                "created_at": "2026-01-15T10:30:00Z",
                "description": "Local area network",
                "id": "550e8400-e29b-41d4-a716-446655440004",
                "name": "LAN",
                "network_id": "550e8400-e29b-41d4-a716-446655440002",
                "source": {
                  "type": "Manual"
                },
                "subnet_type": "Lan",
                "tags": [],
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Tag": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TagBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ],
              "example": {
                "color": "Green",
                "created_at": "2026-01-15T10:30:00Z",
                "description": "Production environment resources",
                "id": "550e8400-e29b-41d4-a716-44665544000a",
                "name": "production",
                "organization_id": "550e8400-e29b-41d4-a716-446655440001",
                "updated_at": "2026-01-15T10:30:00Z"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_Topology": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/TopologyBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_User": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/UserBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "created_at",
                    "updated_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_Vec_UserApiKey": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "allOf": [
                {
                  "$ref": "#/components/schemas/UserApiKeyBase"
                },
                {
                  "type": "object",
                  "required": [
                    "id",
                    "updated_at",
                    "created_at"
                  ],
                  "properties": {
                    "created_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    },
                    "id": {
                      "type": "string",
                      "format": "uuid",
                      "readOnly": true
                    },
                    "updated_at": {
                      "type": "string",
                      "format": "date-time",
                      "readOnly": true
                    }
                  }
                }
              ]
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_VersionInfo": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "object",
            "description": "Version information for API compatibility checking",
            "required": [
              "api_version",
              "server_version"
            ],
            "properties": {
              "api_version": {
                "type": "integer",
                "format": "int32",
                "description": "Current API version (integer, increments on breaking changes)",
                "minimum": 0
              },
              "min_compatible_client": {
                "type": [
                  "string",
                  "null"
                ],
                "description": "Minimum client version that can use this API (optional, for future use)"
              },
              "server_version": {
                "type": "string",
                "description": "Server version (semver)",
                "example": "0.12.10"
              }
            }
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_bool": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "boolean"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "ApiResponse_u32": {
        "type": "object",
        "required": [
          "success",
          "meta"
        ],
        "properties": {
          "data": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "meta": {
            "$ref": "#/components/schemas/ApiMeta"
          },
          "success": {
            "type": "boolean"
          }
        }
      },
      "BillingPlan": {
        "oneOf": [
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Community"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Starter"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Pro"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Team"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Business"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Enterprise"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Demo"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "CommercialSelfHosted"
                    ]
                  }
                }
              }
            ]
          }
        ]
      },
      "BillingRate": {
        "type": "string",
        "enum": [
          "Month",
          "Year"
        ]
      },
      "Binding": {
        "allOf": [
          {
            "$ref": "#/components/schemas/BindingBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "description": "Association between a service and a port / interface that the service is listening on",
        "example": {
<<<<<<< HEAD
          "created_at": "2026-01-06T20:35:46.456074Z",
          "id": "ac774f68-89a5-4c5f-8336-d2e8aadf048b",
=======
          "created_at": "2026-01-06T18:14:22.470445Z",
          "id": "c52b837b-6ca7-4220-aa27-53a5be81ed94",
>>>>>>> fix/discovery-duplicates
          "interface_id": "550e8400-e29b-41d4-a716-446655440005",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "port_id": "550e8400-e29b-41d4-a716-446655440006",
          "service_id": "550e8400-e29b-41d4-a716-446655440007",
          "type": "Port",
<<<<<<< HEAD
          "updated_at": "2026-01-06T20:35:46.456074Z"
=======
          "updated_at": "2026-01-06T18:14:22.470445Z"
>>>>>>> fix/discovery-duplicates
        }
      },
      "BindingBase": {
        "allOf": [
          {
            "$ref": "#/components/schemas/BindingType"
          },
          {
            "type": "object",
            "required": [
              "service_id",
              "network_id"
            ],
            "properties": {
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "service_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "description": "The base data for a Binding entity (everything except id, created_at, updated_at)"
      },
      "BindingInput": {
        "oneOf": [
          {
            "type": "object",
            "title": "Interface",
            "description": "Bind to an interface (service is present at this interface without a specific port)",
            "required": [
              "id",
              "interface_id",
              "type"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Client-provided UUID for this binding"
              },
              "interface_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Port",
            "description": "Bind to a port (optionally on a specific interface)",
            "required": [
              "id",
              "port_id",
              "type"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid",
                "description": "Client-provided UUID for this binding"
              },
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid",
                "description": "null = bind to all interfaces"
              },
              "port_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Port"
                ]
              }
            }
          }
        ],
        "description": "Input for creating or updating a binding within a service.\nUsed in both CreateHostRequest and UpdateHostRequest.\nClient must provide a UUID for the binding."
      },
      "BindingType": {
        "oneOf": [
          {
            "type": "object",
            "title": "Interface",
            "description": "Interface binding: Service is present at an interface (IP address) without a specific port.\nUsed for non-port-bound services like gateways. Conflicts with port bindings on the same interface.",
            "required": [
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Port",
            "description": "Port binding: Service listens on a specific port, optionally on a specific interface.\nIf `interface_id` is `null`, the service listens on this port across all interfaces,\nwhich supersedes any specific-interface bindings for the same port.",
            "required": [
              "port_id",
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid",
                "description": "The interface this port binding applies to. If `null`, the binding applies to all\ninterfaces on the host (and supersedes specific-interface bindings for this port)."
              },
              "port_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Port"
                ]
              }
            }
          }
        ],
        "description": "The type of binding - either to an interface or to a port.\n\nBindings associate a service with network resources (interfaces/ports) on a host.\n\n## Validation Rules\n\n- All bindings must reference ports/interfaces that belong to the same host as the service.\n- Interface bindings conflict with port bindings on the same interface.\n- A port binding on all interfaces (`interface_id: null`) conflicts with any interface binding.\n- When a port binding with `interface_id: null` is created, it supersedes (removes) any\n  existing specific-interface bindings for the same port."
      },
      "BulkDeleteResponse": {
        "type": "object",
        "required": [
          "deleted_count",
          "requested_count"
        ],
        "properties": {
          "deleted_count": {
            "type": "integer",
            "minimum": 0
          },
          "requested_count": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "Color": {
        "type": "string",
        "enum": [
          "Pink",
          "Rose",
          "Red",
          "Orange",
          "Green",
          "Emerald",
          "Teal",
          "Cyan",
          "Blue",
          "Indigo",
          "Purple",
          "Gray",
          "Yellow"
        ]
      },
      "CreateBindingInput": {
        "oneOf": [
          {
            "type": "object",
            "title": "Interface",
            "description": "Bind to an interface (service listens on all ports on this interface)",
            "required": [
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Port",
            "description": "Bind to a port (optionally on a specific interface)",
            "required": [
              "port_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid"
              },
              "port_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Port"
                ]
              }
            }
          }
        ],
        "description": "Input for creating a binding with a service.\n`service_id` and `network_id` are assigned by the server after the service is created."
      },
      "CreateCheckoutRequest": {
        "type": "object",
        "required": [
          "plan",
          "url"
        ],
        "properties": {
          "plan": {
            "$ref": "#/components/schemas/BillingPlan"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "CreateHostRequest": {
        "type": "object",
        "description": "Request type for creating a host with its associated interfaces, ports, and services.\nServer assigns `host_id`, `network_id`, and `source` to all children.\nClient must provide UUIDs for all entities, enabling services to reference\ninterfaces/ports by ID in the same request.",
        "required": [
          "name",
          "network_id",
          "tags"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InterfaceInput"
            },
            "description": "Interfaces to create with this host (client provides UUIDs)"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortInput"
            },
            "description": "Ports to create with this host (client provides UUIDs)"
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceInput"
            },
            "description": "Services to create with this host (can reference interfaces/ports by their UUIDs)"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        },
        "example": {
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "interfaces": [
            {
              "id": "550e8400-e29b-41d4-a716-446655440005",
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "position": 0,
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004"
            }
          ],
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "ports": [
            {
              "id": "550e8400-e29b-41d4-a716-446655440006",
              "number": 80,
              "protocol": "Tcp"
            }
          ],
          "services": [
            {
              "bindings": [
                {
                  "id": "550e8400-e29b-41d4-a716-446655440009",
                  "interface_id": "550e8400-e29b-41d4-a716-446655440005",
                  "port_id": "550e8400-e29b-41d4-a716-446655440006",
                  "type": "Port"
                }
              ],
              "id": "550e8400-e29b-41d4-a716-446655440007",
              "name": "nginx",
              "position": 0,
<<<<<<< HEAD
              "service_definition": "Confluence",
=======
              "service_definition": "Lidarr",
>>>>>>> fix/discovery-duplicates
              "tags": [],
              "virtualization": null
            }
          ],
          "tags": [],
          "virtualization": null
        }
      },
      "CreateInviteRequest": {
        "type": "object",
        "required": [
          "permissions",
          "network_ids"
        ],
        "properties": {
          "expiration_hours": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "send_to": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "CreateServiceRequest": {
        "type": "object",
        "description": "Request type for creating a service.\nServer assigns `id`, `created_at`, `updated_at`, and `source`.\nServer also assigns `service_id` and `network_id` to all bindings.",
        "required": [
          "host_id",
          "network_id",
          "service_definition",
          "name",
          "tags"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateBindingInput"
            },
            "description": "Bindings to create with the service.\n`service_id` and `network_id` are assigned by the server."
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "service_definition": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServiceVirtualization"
              }
            ]
          }
        }
      },
      "CreateUpdateShareRequest": {
        "type": "object",
        "required": [
          "share"
        ],
        "properties": {
          "password": {
            "type": [
              "string",
              "null"
            ]
          },
          "share": {
            "$ref": "#/components/schemas/Share"
          }
        }
      },
      "Daemon": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DaemonBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "updated_at",
              "created_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DaemonApiKey": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DaemonApiKeyBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "updated_at",
              "created_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DaemonApiKeyBase": {
        "type": "object",
        "required": [
          "key",
          "name",
          "last_used",
          "network_id",
          "tags"
        ],
        "properties": {
          "expires_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "key": {
            "type": "string",
            "readOnly": true
          },
          "last_used": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "readOnly": true
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DaemonApiKeyResponse": {
        "type": "object",
        "required": [
          "api_key",
          "key"
        ],
        "properties": {
          "api_key": {
            "$ref": "#/components/schemas/DaemonApiKey"
          },
          "key": {
            "type": "string"
          }
        }
      },
      "DaemonBase": {
        "type": "object",
        "required": [
          "host_id",
          "network_id",
          "url",
          "last_seen",
          "capabilities",
          "mode",
          "name",
          "tags",
          "user_id"
        ],
        "properties": {
          "capabilities": {
            "$ref": "#/components/schemas/DaemonCapabilities"
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "last_seen": {
            "type": "string",
            "format": "date-time",
            "readOnly": true
          },
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "url": {
            "type": "string",
            "readOnly": true
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User responsible for maintaining this daemon"
          },
          "version": {
            "type": [
              "string",
              "null"
            ],
            "description": "Daemon software version (semver format)"
          }
        }
      },
      "DaemonCapabilities": {
        "type": "object",
        "description": "Daemon capabilities",
        "required": [
          "interfaced_subnet_ids"
        ],
        "properties": {
          "has_docker_socket": {
            "type": "boolean"
          },
          "interfaced_subnet_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DaemonHeartbeatPayload": {
        "type": "object",
        "required": [
          "url",
          "name",
          "mode"
        ],
        "properties": {
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "DaemonMode": {
        "type": "string",
        "enum": [
          "Push",
          "Pull"
        ]
      },
      "DaemonRegistrationRequest": {
        "type": "object",
        "description": "Daemon registration request from daemon to server",
        "required": [
          "daemon_id",
          "network_id",
          "name",
          "url",
          "mode",
          "capabilities"
        ],
        "properties": {
          "capabilities": {
            "$ref": "#/components/schemas/DaemonCapabilities"
          },
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "url": {
            "type": "string"
          },
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "User responsible for maintaining this daemon (from frontend install command)\nOptional for backwards compat with old daemons - defaults to nil UUID"
          },
          "version": {
            "type": [
              "string",
              "null"
            ],
            "description": "Daemon software version (optional for backwards compat with old daemons)"
          }
        }
      },
      "DaemonRegistrationResponse": {
        "type": "object",
        "description": "Daemon registration response from server to daemon",
        "required": [
          "daemon",
          "host_id"
        ],
        "properties": {
          "daemon": {
            "$ref": "#/components/schemas/Daemon"
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "server_capabilities": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServerCapabilities",
                "description": "Server capabilities (returned if daemon sends version info)"
              }
            ]
          }
        }
      },
      "DaemonResponse": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DaemonBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at",
              "version_status"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time"
              },
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "updated_at": {
                "type": "string",
                "format": "date-time"
              },
              "version_status": {
                "$ref": "#/components/schemas/DaemonVersionStatus",
                "description": "Computed version status including health and warnings"
              }
            }
          }
        ],
        "description": "Daemon response for UI including computed version status"
      },
      "DaemonSetupRequest": {
        "type": "object",
        "description": "Daemon setup request for pre-registration daemon configuration",
        "required": [
          "daemon_name",
          "network_id"
        ],
        "properties": {
          "daemon_name": {
            "type": "string"
          },
          "install_later": {
            "type": "boolean"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "DaemonSetupResponse": {
        "type": "object",
        "description": "Response from daemon setup endpoint",
        "properties": {
          "api_key": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "DaemonStartupRequest": {
        "type": "object",
        "description": "Sent by daemon on startup to report version",
        "required": [
          "daemon_version"
        ],
        "properties": {
          "daemon_version": {
            "type": "string",
            "description": "Daemon software version (semver format)"
          }
        }
      },
      "DaemonVersionStatus": {
        "type": "object",
        "description": "Daemon version status including health and any warnings",
        "required": [
          "status"
        ],
        "properties": {
          "status": {
            "$ref": "#/components/schemas/VersionHealthStatus"
          },
          "version": {
            "type": [
              "string",
              "null"
            ]
          },
          "warnings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DeprecationWarning"
            }
          }
        }
      },
      "DeploymentType": {
        "type": "string",
        "enum": [
          "cloud",
          "commercial",
          "community"
        ]
      },
      "DeprecationSeverity": {
        "type": "string",
        "description": "Severity level for deprecation warnings",
        "enum": [
          "Info",
          "Warning",
          "Critical"
        ]
      },
      "DeprecationWarning": {
        "type": "object",
        "description": "Deprecation warning for daemon version",
        "required": [
          "message",
          "severity"
        ],
        "properties": {
          "message": {
            "type": "string"
          },
          "severity": {
            "$ref": "#/components/schemas/DeprecationSeverity"
          },
          "sunset_date": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "Discovery": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DiscoveryBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DiscoveryBase": {
        "type": "object",
        "required": [
          "discovery_type",
          "run_type",
          "name",
          "daemon_id",
          "network_id",
          "tags"
        ],
        "properties": {
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "discovery_type": {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "run_type": {
            "$ref": "#/components/schemas/RunType"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DiscoveryHostRequest": {
        "type": "object",
        "description": "Request type for daemon discovery - accepts full entities with IDs.\nUsed internally by daemons for host creation/upsert, NOT the external API.\nThis supports the discovery workflow where daemons manage entity IDs.",
        "required": [
          "host",
          "interfaces",
          "ports",
          "services"
        ],
        "properties": {
          "host": {
            "$ref": "#/components/schemas/Host"
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          }
        }
      },
      "DiscoveryMetadata": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          {
            "type": "object",
            "required": [
              "daemon_id",
              "date"
            ],
            "properties": {
              "daemon_id": {
                "type": "string",
                "format": "uuid"
              },
              "date": {
                "type": "string",
                "format": "date-time"
              }
            }
          }
        ]
      },
      "DiscoveryPhase": {
        "type": "string",
        "enum": [
          "Pending",
          "Starting",
          "Started",
          "Scanning",
          "Complete",
          "Failed",
          "Cancelled"
        ]
      },
      "DiscoveryType": {
        "oneOf": [
          {
            "type": "object",
            "title": "SelfReport",
            "required": [
              "host_id",
              "type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "SelfReport"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Network",
            "required": [
              "subnet_ids",
              "host_naming_fallback",
              "type"
            ],
            "properties": {
              "host_naming_fallback": {
                "$ref": "#/components/schemas/HostNamingFallback"
              },
              "subnet_ids": {
                "type": [
                  "array",
                  "null"
                ],
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "Network"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Docker",
            "required": [
              "host_id",
              "host_naming_fallback",
              "type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "host_naming_fallback": {
                "$ref": "#/components/schemas/HostNamingFallback"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Docker"
                ]
              }
            }
          }
        ]
      },
      "DiscoveryUpdatePayload": {
        "type": "object",
        "description": "Progress update from daemon to server during discovery",
        "required": [
          "session_id",
          "daemon_id",
          "network_id",
          "phase",
          "discovery_type",
          "progress"
        ],
        "properties": {
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "discovery_type": {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "finished_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "phase": {
            "$ref": "#/components/schemas/DiscoveryPhase"
          },
          "progress": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "session_id": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "DockerVirtualization": {
        "type": "object",
        "required": [
          "service_id"
        ],
        "properties": {
          "container_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "container_name": {
            "type": [
              "string",
              "null"
            ]
          },
          "service_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "Edge": {
        "allOf": [
          {
            "$ref": "#/components/schemas/EdgeType"
          },
          {
            "type": "object",
            "required": [
              "id",
              "source",
              "target",
              "label",
              "source_handle",
              "target_handle",
              "is_multi_hop"
            ],
            "properties": {
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "is_multi_hop": {
                "type": "boolean"
              },
              "label": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "source": {
                "type": "string",
                "format": "uuid"
              },
              "source_handle": {
                "$ref": "#/components/schemas/EdgeHandle"
              },
              "target": {
                "type": "string",
                "format": "uuid"
              },
              "target_handle": {
                "$ref": "#/components/schemas/EdgeHandle"
              }
            }
          }
        ]
      },
      "EdgeHandle": {
        "type": "string",
        "enum": [
          "Top",
          "Bottom",
          "Left",
          "Right"
        ]
      },
      "EdgeStyle": {
        "type": "string",
        "enum": [
          "Straight",
          "SmoothStep",
          "Step",
          "Bezier",
          "SimpleBezier"
        ]
      },
      "EdgeType": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "host_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              },
              "host_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "vm_service_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "HostVirtualization"
                ]
              },
              "vm_service_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "host_id",
              "containerizing_service_id",
              "edge_type"
            ],
            "properties": {
              "containerizing_service_id": {
                "type": "string",
                "format": "uuid"
              },
              "edge_type": {
                "type": "string",
                "enum": [
                  "ServiceVirtualization"
                ]
              },
              "host_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "group_id",
              "source_binding_id",
              "target_binding_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "RequestPath"
                ]
              },
              "group_id": {
                "type": "string",
                "format": "uuid"
              },
              "source_binding_id": {
                "type": "string",
                "format": "uuid"
              },
              "target_binding_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "group_id",
              "source_binding_id",
              "target_binding_id",
              "edge_type"
            ],
            "properties": {
              "edge_type": {
                "type": "string",
                "enum": [
                  "HubAndSpoke"
                ]
              },
              "group_id": {
                "type": "string",
                "format": "uuid"
              },
              "source_binding_id": {
                "type": "string",
                "format": "uuid"
              },
              "target_binding_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ]
      },
      "EdgeTypeDiscriminants": {
        "type": "string",
        "enum": [
          "Interface",
          "HostVirtualization",
          "ServiceVirtualization",
          "RequestPath",
          "HubAndSpoke"
        ]
      },
      "EntityMetadata": {
        "type": "object",
        "required": [
          "id",
          "color",
          "icon"
        ],
        "properties": {
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "icon": {
            "type": "string"
          },
          "id": {
            "type": "string"
          }
        }
      },
      "EntitySource": {
        "oneOf": [
          {
            "type": "object",
            "title": "Manual",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "Manual"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "System",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "System"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Discovery",
            "required": [
              "metadata",
              "type"
            ],
            "properties": {
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DiscoveryMetadata"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "Discovery"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "DiscoveryWithMatch",
            "required": [
              "metadata",
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/MatchDetails"
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DiscoveryMetadata"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "DiscoveryWithMatch"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Unknown",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "Unknown"
                ]
              }
            }
          }
        ]
      },
      "ForgotPasswordRequest": {
        "type": "object",
        "required": [
          "email"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          }
        }
      },
      "Group": {
        "allOf": [
          {
            "$ref": "#/components/schemas/GroupBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "binding_ids": [],
          "color": "Blue",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "HTTP/HTTPS services group",
          "edge_style": "Bezier",
          "group_type": "RequestPath",
          "id": "550e8400-e29b-41d4-a716-446655440008",
          "name": "Web Services",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "GroupBase": {
        "type": "object",
        "required": [
          "name",
          "network_id",
          "group_type",
          "binding_ids",
          "color",
          "edge_style",
          "tags"
        ],
        "properties": {
          "binding_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Ordered list of binding IDs for this group."
          },
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "edge_style": {
            "$ref": "#/components/schemas/EdgeStyle"
          },
          "group_type": {
            "$ref": "#/components/schemas/GroupType"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource",
            "description": "Will be automatically set to Manual for creation through API"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "GroupType": {
        "type": "string",
        "enum": [
          "RequestPath",
          "HubAndSpoke"
        ]
      },
      "Host": {
        "allOf": [
          {
            "$ref": "#/components/schemas/HostBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "id": "550e8400-e29b-41d4-a716-446655440003",
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "HostBase": {
        "type": "object",
        "description": "Base data for a Host entity (stored in database).\nChild entities (interfaces, ports, services) are stored in their own tables\nand queried by `host_id`. They are NOT stored on the host.",
        "required": [
          "name",
          "network_id",
          "hostname",
          "description",
          "source",
          "virtualization",
          "hidden",
          "tags"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        }
      },
      "HostNamingFallback": {
        "type": "string",
        "enum": [
          "Ip",
          "BestService"
        ]
      },
      "HostResponse": {
        "type": "object",
        "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
        "required": [
          "id",
          "created_at",
          "updated_at",
          "name",
          "network_id",
          "source",
          "hidden",
          "tags",
          "interfaces",
          "ports",
          "services"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        },
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "id": "550e8400-e29b-41d4-a716-446655440003",
          "interfaces": [
            {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440005",
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "position": 0,
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          ],
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "ports": [
            {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440006",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "number": 80,
              "protocol": "Tcp",
              "type": "Http",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          ],
          "services": [],
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "HostVirtualization": {
        "oneOf": [
          {
            "type": "object",
            "title": "Proxmox",
            "required": [
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/ProxmoxVirtualization"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Proxmox"
                ]
              }
            }
          }
        ],
        "title": "HostVirtualization"
      },
      "Interface": {
        "allOf": [
          {
            "$ref": "#/components/schemas/InterfaceBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440005",
          "ip_address": "192.168.1.100",
          "mac_address": "DE:AD:BE:EF:12:34",
          "name": "eth0",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "position": 0,
          "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "InterfaceBase": {
        "type": "object",
        "required": [
          "network_id",
          "host_id",
          "subnet_id",
          "ip_address",
          "mac_address",
          "name"
        ],
        "properties": {
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "position": {
            "type": "integer",
            "format": "int32",
            "description": "Position of this interface in the host's interface list (for ordering)"
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "InterfaceInput": {
        "type": "object",
        "description": "Input for creating or updating an interface.\nUsed in both CreateHostRequest and UpdateHostRequest.\nClient must provide a UUID for the interface.",
        "required": [
          "id",
          "subnet_id",
          "ip_address"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Client-provided UUID for this interface"
          },
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "position": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "Position in the host's interface list (for ordering).\nIf omitted on create: appends to end of list.\nIf omitted on update: existing interfaces keep their positions; new interfaces append.\nMust be all specified or all omitted across all interfaces in the request."
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "Invite": {
        "allOf": [
          {
            "$ref": "#/components/schemas/InviteBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "InviteBase": {
        "type": "object",
        "required": [
          "organization_id",
          "permissions",
          "network_ids",
          "url",
          "created_by",
          "expires_at",
          "send_to"
        ],
        "properties": {
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "send_to": {
            "type": [
              "string",
              "null"
            ],
            "description": "Optional email address to send the invite to"
          },
          "url": {
            "type": "string"
          }
        }
      },
      "Ixy": {
        "type": "object",
        "required": [
          "x",
          "y"
        ],
        "properties": {
          "x": {
            "type": "integer"
          },
          "y": {
            "type": "integer"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "description": "Login request from client",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          },
          "password": {
            "type": "string"
          }
        }
      },
      "MatchConfidence": {
        "type": "string",
        "enum": [
          "NotApplicable",
          "Low",
          "Medium",
          "High",
          "Certain"
        ]
      },
      "MatchDetails": {
        "type": "object",
        "required": [
          "reason",
          "confidence"
        ],
        "properties": {
          "confidence": {
            "$ref": "#/components/schemas/MatchConfidence"
          },
          "reason": {
            "$ref": "#/components/schemas/MatchReason"
          }
        }
      },
      "MatchReason": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "type",
              "data"
            ],
            "properties": {
              "data": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "reason"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "type",
              "data"
            ],
            "properties": {
              "data": {
                "type": "array",
                "items": {},
                "description": "Tuple of [name: string, children: MatchReason[]]"
              },
              "type": {
                "type": "string",
                "enum": [
                  "container"
                ]
              }
            }
          }
        ],
        "description": "Match reason - either a simple reason string or a container with nested reasons"
      },
      "MetadataRegistry": {
        "type": "object",
        "required": [
          "service_definitions",
          "subnet_types",
          "edge_types",
          "group_types",
          "entities",
          "ports",
          "discovery_types",
          "billing_plans",
          "features",
          "permissions",
          "concepts"
        ],
        "properties": {
          "billing_plans": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "concepts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntityMetadata"
            }
          },
          "discovery_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "edge_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "entities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EntityMetadata"
            }
          },
          "features": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "group_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "permissions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "service_definitions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          },
          "subnet_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TypeMetadata"
            }
          }
        }
      },
      "Network": {
        "allOf": [
          {
            "$ref": "#/components/schemas/NetworkBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "id": "550e8400-e29b-41d4-a716-446655440002",
          "name": "Home Network",
          "organization_id": "550e8400-e29b-41d4-a716-446655440001",
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "NetworkBase": {
        "type": "object",
        "required": [
          "name",
          "organization_id",
          "tags"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "NetworkSetup": {
        "type": "object",
        "description": "Network configuration for setup",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string"
          }
        }
      },
      "Node": {
        "allOf": [
          {
            "$ref": "#/components/schemas/NodeType"
          },
          {
            "type": "object",
            "required": [
              "id",
              "position",
              "size"
            ],
            "properties": {
              "header": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "id": {
                "type": "string",
                "format": "uuid"
              },
              "position": {
                "$ref": "#/components/schemas/Ixy"
              },
              "size": {
                "$ref": "#/components/schemas/Uxy"
              }
            }
          }
        ]
      },
      "NodeType": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "infra_width",
              "node_type"
            ],
            "properties": {
              "infra_width": {
                "type": "integer",
                "minimum": 0
              },
              "node_type": {
                "type": "string",
                "enum": [
                  "SubnetNode"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "subnet_id",
              "host_id",
              "is_infra",
              "node_type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid"
              },
              "is_infra": {
                "type": "boolean"
              },
              "node_type": {
                "type": "string",
                "enum": [
                  "InterfaceNode"
                ]
              },
              "subnet_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ]
      },
      "OidcProviderMetadata": {
        "type": "object",
        "required": [
          "name",
          "slug"
        ],
        "properties": {
          "logo": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          }
        }
      },
      "Organization": {
        "allOf": [
          {
            "$ref": "#/components/schemas/OrganizationBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "OrganizationBase": {
        "type": "object",
        "required": [
          "stripe_customer_id",
          "name",
          "plan",
          "plan_status",
          "onboarding"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "onboarding": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TelemetryOperation"
            }
          },
          "plan": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/BillingPlan"
              }
            ]
          },
          "plan_status": {
            "type": [
              "string",
              "null"
            ],
            "readOnly": true
          },
          "stripe_customer_id": {
            "type": [
              "string",
              "null"
            ],
            "readOnly": true
          }
        }
      },
      "PaginationMeta": {
        "type": "object",
        "description": "Pagination metadata returned with paginated responses.",
        "required": [
          "total_count",
          "limit",
          "offset",
          "has_more"
        ],
        "properties": {
          "has_more": {
            "type": "boolean",
            "description": "Whether there are more items after this page"
          },
          "limit": {
            "type": "integer",
            "format": "int32",
            "description": "Maximum items per page (as requested)",
            "minimum": 0
          },
          "offset": {
            "type": "integer",
            "format": "int32",
            "description": "Number of items skipped",
            "minimum": 0
          },
          "total_count": {
            "type": "integer",
            "format": "int64",
            "description": "Total number of items matching the filter (ignoring pagination)",
            "minimum": 0
          }
        }
      },
      "PaginationParams": {
        "type": "object",
        "description": "Pagination parameters that can be composed into filter queries.\n\nDefault behavior:\n- `limit`: 50 (returns up to 50 results)\n- `offset`: 0 (starts from the beginning)\n- `limit=0`: Returns all results (unlimited)\n- Maximum `limit`: 1000 (to prevent abuse)",
        "properties": {
          "limit": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "Maximum number of results to return. Default: 50. Use 0 for unlimited.",
            "minimum": 0
          },
          "offset": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "Number of results to skip. Default: 0.",
            "minimum": 0
          }
        }
      },
      "PlanConfig": {
        "type": "object",
        "required": [
          "base_cents",
          "rate",
          "trial_days"
        ],
        "properties": {
          "base_cents": {
            "type": "integer",
            "format": "int64"
          },
          "included_networks": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "minimum": 0
          },
          "included_seats": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "minimum": 0
          },
          "network_cents": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "rate": {
            "$ref": "#/components/schemas/BillingRate"
          },
          "seat_cents": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "trial_days": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "Port": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PortBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "description": "Port entity with custom serialization that flattens PortType fields.",
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440006",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "number": 80,
          "protocol": "Tcp",
          "type": "Http",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "PortBase": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PortType"
          },
          {
            "type": "object",
            "required": [
              "host_id",
              "network_id"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "description": "The base data for a Port entity (everything except id, created_at, updated_at)"
      },
      "PortInput": {
        "type": "object",
        "description": "Input for creating or updating a port.\nUsed in both CreateHostRequest and UpdateHostRequest.\nClient must provide a UUID for the port.",
        "required": [
          "id",
          "number",
          "protocol"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Client-provided UUID for this port"
          },
          "number": {
            "type": "integer",
            "format": "int32",
            "description": "Port number (1-65535)",
            "minimum": 0
          },
          "protocol": {
            "$ref": "#/components/schemas/TransportProtocol",
            "description": "Transport protocol (Tcp or Udp)"
          }
        }
      },
      "PortType": {
        "type": "object",
        "description": "Port type with number, protocol, and optional type identifier",
        "required": [
          "number",
          "protocol"
        ],
        "properties": {
          "number": {
            "type": "integer"
          },
          "protocol": {
            "type": "string",
            "enum": [
              "Udp",
              "Tcp"
            ]
          },
          "type": {
            "type": "string",
            "description": "Auto-derived from number+protocol; optional on create"
          }
        }
      },
      "ProxmoxVirtualization": {
        "type": "object",
        "required": [
          "service_id"
        ],
        "properties": {
          "service_id": {
            "type": "string",
            "format": "uuid"
          },
          "vm_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "vm_name": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "PublicConfigResponse": {
        "type": "object",
        "required": [
          "server_port",
          "disable_registration",
          "oidc_providers",
          "billing_enabled",
          "has_integrated_daemon",
          "has_email_service",
          "has_email_opt_in",
          "public_url",
          "needs_cookie_consent",
          "deployment_type"
        ],
        "properties": {
          "billing_enabled": {
            "type": "boolean"
          },
          "deployment_type": {
            "$ref": "#/components/schemas/DeploymentType"
          },
          "disable_registration": {
            "type": "boolean"
          },
          "has_email_opt_in": {
            "type": "boolean"
          },
          "has_email_service": {
            "type": "boolean"
          },
          "has_integrated_daemon": {
            "type": "boolean"
          },
          "needs_cookie_consent": {
            "type": "boolean"
          },
          "oidc_providers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OidcProviderMetadata"
            }
          },
          "plunk_key": {
            "type": [
              "string",
              "null"
            ]
          },
          "posthog_key": {
            "type": [
              "string",
              "null"
            ]
          },
          "public_url": {
            "type": "string"
          },
          "server_port": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "PublicShareMetadata": {
        "type": "object",
        "description": "Public share metadata (returned without authentication)",
        "required": [
          "id",
          "name",
          "requires_password",
          "options"
        ],
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "options": {
            "$ref": "#/components/schemas/ShareOptions"
          },
          "requires_password": {
            "type": "boolean"
          }
        }
      },
      "RegisterRequest": {
        "type": "object",
        "description": "Registration request from client",
        "required": [
          "email",
          "password",
          "terms_accepted"
        ],
        "properties": {
          "email": {
            "type": "string",
            "format": "email"
          },
          "password": {
            "type": "string"
          },
          "terms_accepted": {
            "type": "boolean"
          }
        }
      },
      "ResetPasswordRequest": {
        "type": "object",
        "required": [
          "token",
          "password"
        ],
        "properties": {
          "password": {
            "type": "string"
          },
          "token": {
            "type": "string"
          }
        }
      },
      "RunType": {
        "oneOf": [
          {
            "type": "object",
            "title": "Scheduled",
            "required": [
              "cron_schedule",
              "enabled",
              "type"
            ],
            "properties": {
              "cron_schedule": {
                "type": "string"
              },
              "enabled": {
                "type": "boolean"
              },
              "last_run": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time",
                "readOnly": true
              },
              "type": {
                "type": "string",
                "enum": [
                  "Scheduled"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Historical",
            "description": "Historical discovery runs are created by the server and cannot be submitted via API",
            "required": [
              "results",
              "type"
            ],
            "properties": {
              "results": {
                "$ref": "#/components/schemas/DiscoveryUpdatePayload"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Historical"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "AdHoc",
            "required": [
              "type"
            ],
            "properties": {
              "last_run": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time",
                "readOnly": true
              },
              "type": {
                "type": "string",
                "enum": [
                  "AdHoc"
                ]
              }
            }
          }
        ]
      },
      "ServerCapabilities": {
        "type": "object",
        "description": "Server capabilities returned on startup/registration",
        "required": [
          "server_version",
          "minimum_daemon_version"
        ],
        "properties": {
          "deprecation_warnings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DeprecationWarning"
            },
            "description": "Deprecation warnings for the daemon"
          },
          "minimum_daemon_version": {
            "type": "string",
            "description": "Minimum daemon version supported by this server"
          },
          "server_version": {
            "type": "string",
            "description": "Server software version"
          }
        }
      },
      "Service": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ServiceBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "bindings": [
            {
<<<<<<< HEAD
              "created_at": "2026-01-06T20:35:46.456023Z",
              "id": "9b02f49d-7fca-4239-8d0e-8a343d64135b",
=======
              "created_at": "2026-01-06T18:14:22.470348Z",
              "id": "058b513f-d7ee-470f-9afa-69fd824fe0e6",
>>>>>>> fix/discovery-duplicates
              "interface_id": "550e8400-e29b-41d4-a716-446655440005",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "port_id": "550e8400-e29b-41d4-a716-446655440006",
              "service_id": "550e8400-e29b-41d4-a716-446655440007",
              "type": "Port",
<<<<<<< HEAD
              "updated_at": "2026-01-06T20:35:46.456023Z"
=======
              "updated_at": "2026-01-06T18:14:22.470348Z"
>>>>>>> fix/discovery-duplicates
            }
          ],
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440007",
          "name": "nginx",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "position": 0,
<<<<<<< HEAD
          "service_definition": "Confluence",
=======
          "service_definition": "Lidarr",
>>>>>>> fix/discovery-duplicates
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "ServiceBase": {
        "type": "object",
        "required": [
          "host_id",
          "network_id",
          "service_definition",
          "name",
          "bindings",
          "source",
          "tags",
          "position"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Binding"
            }
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "position": {
            "type": "integer",
            "format": "int32",
            "description": "Position of this service in the host's service list (for ordering)"
          },
          "service_definition": {
            "type": "string"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource",
            "description": "Will be automatically set to Manual for creation through API"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServiceVirtualization"
              }
            ]
          }
        }
      },
      "ServiceCategory": {
        "type": "string",
        "enum": [
          "NetworkCore",
          "NetworkAccess",
          "NetworkSecurity",
          "Storage",
          "Backup",
          "Media",
          "HomeAutomation",
          "Virtualization",
          "DNS",
          "VPN",
          "Monitoring",
          "AdBlock",
          "ReverseProxy",
          "Workstation",
          "Mobile",
          "IoT",
          "Printer",
          "Database",
          "Development",
          "Dashboard",
          "MessageQueue",
          "IdentityAndAccess",
          "Office",
          "ProjectManagement",
          "Messaging",
          "Conferencing",
          "Telephony",
          "Email",
          "Publishing",
          "Unknown",
          "Custom",
          "Scanopy",
          "OpenPorts"
        ]
      },
      "ServiceInput": {
        "type": "object",
        "description": "Input for creating or updating a service.\nUsed in both CreateHostRequest and UpdateHostRequest.\nClient must provide a UUID for the service.",
        "required": [
          "id",
          "service_definition",
          "name"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BindingInput"
            },
            "description": "Bindings that associate this service with ports/interfaces"
          },
          "id": {
            "type": "string",
            "format": "uuid",
            "description": "Client-provided UUID for this service"
          },
          "name": {
            "type": "string",
            "description": "Display name for this service"
          },
          "position": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "Position in the host's service list (for ordering).\nIf omitted on create: appends to end of list.\nIf omitted on update: existing services keep their positions; new services append.\nMust be all specified or all omitted across all services in the request."
          },
          "service_definition": {
            "type": "string",
            "description": "Service definition ID (e.g., \"Nginx\", \"PostgreSQL\")"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Tags for categorization"
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServiceVirtualization",
                "description": "Container/VM virtualization info if applicable"
              }
            ]
          }
        }
      },
      "ServiceVirtualization": {
        "oneOf": [
          {
            "type": "object",
            "title": "Docker",
            "required": [
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/DockerVirtualization"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Docker"
                ]
              }
            }
          }
        ],
        "title": "ServiceVirtualization"
      },
      "SetupRequest": {
        "type": "object",
        "description": "Setup request for pre-registration org/network configuration",
        "required": [
          "organization_name",
          "networks"
        ],
        "properties": {
          "networks": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NetworkSetup"
            }
          },
          "organization_name": {
            "type": "string"
          }
        }
      },
      "SetupResponse": {
        "type": "object",
        "description": "Response from setup endpoint",
        "required": [
          "network_ids"
        ],
        "properties": {
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "Share": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ShareBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "ShareBase": {
        "type": "object",
        "required": [
          "topology_id",
          "network_id",
          "created_by",
          "name",
          "is_enabled",
          "expires_at",
          "allowed_domains",
          "options"
        ],
        "properties": {
          "allowed_domains": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "type": "string"
            }
          },
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "expires_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "options": {
            "$ref": "#/components/schemas/ShareOptions"
          },
          "topology_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "ShareOptions": {
        "type": "object",
        "description": "Share display options",
        "required": [
          "show_inspect_panel",
          "show_zoom_controls",
          "show_export_button"
        ],
        "properties": {
          "show_export_button": {
            "type": "boolean"
          },
          "show_inspect_panel": {
            "type": "boolean"
          },
          "show_zoom_controls": {
            "type": "boolean"
          }
        }
      },
      "Subnet": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SubnetBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "cidr": "192.168.1.0/24",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Local area network",
          "id": "550e8400-e29b-41d4-a716-446655440004",
          "name": "LAN",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "subnet_type": "Lan",
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "SubnetBase": {
        "type": "object",
        "required": [
          "cidr",
          "network_id",
          "name",
          "subnet_type",
          "source",
          "tags"
        ],
        "properties": {
          "cidr": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource",
            "description": "Will be automatically set to Manual for creation through API"
          },
          "subnet_type": {
            "$ref": "#/components/schemas/SubnetType"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "SubnetType": {
        "type": "string",
        "enum": [
          "Internet",
          "Remote",
          "Gateway",
          "VpnTunnel",
          "Dmz",
          "Lan",
          "WiFi",
          "IoT",
          "Guest",
          "DockerBridge",
          "Management",
          "Storage",
          "Unknown",
          "None"
        ]
      },
      "Tag": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TagBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "color": "Green",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Production environment resources",
          "id": "550e8400-e29b-41d4-a716-44665544000a",
          "name": "production",
          "organization_id": "550e8400-e29b-41d4-a716-446655440001",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "TagBase": {
        "type": "object",
        "required": [
          "name",
          "color",
          "organization_id"
        ],
        "properties": {
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TelemetryOperation": {
        "type": "string",
        "enum": [
          "OrgCreated",
          "OnboardingModalCompleted",
          "PlanSelected",
          "PersonalPlanSelected",
          "CommercialPlanSelected",
          "FirstApiKeyCreated",
          "FirstDaemonRegistered",
          "FirstTopologyRebuild",
          "CheckoutStarted",
          "CheckoutCompleted",
          "TrialStarted",
          "TrialEnded",
          "SubscriptionCancelled"
        ]
      },
      "Topology": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TopologyBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "TopologyBase": {
        "type": "object",
        "required": [
          "name",
          "options",
          "network_id",
          "tags",
          "nodes",
          "edges",
          "hosts",
          "interfaces",
          "ports",
          "bindings",
          "subnets",
          "services",
          "groups",
          "is_stale",
          "last_refreshed",
          "is_locked",
          "removed_hosts",
          "removed_interfaces",
          "removed_subnets",
          "removed_services",
          "removed_groups",
          "removed_ports",
          "removed_bindings"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Binding"
            }
          },
          "edges": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Edge"
            }
          },
          "groups": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Group"
            }
          },
          "hosts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Host"
            }
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "is_locked": {
            "type": "boolean"
          },
          "is_stale": {
            "type": "boolean"
          },
          "last_refreshed": {
            "type": "string",
            "format": "date-time"
          },
          "locked_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "locked_by": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "nodes": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Node"
            }
          },
          "options": {
            "$ref": "#/components/schemas/TopologyOptions"
          },
          "parent_id": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "removed_bindings": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_groups": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_hosts": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_interfaces": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_ports": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_services": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "removed_subnets": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          },
          "subnets": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Subnet"
            }
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "TopologyLocalOptions": {
        "type": "object",
        "required": [
          "left_zone_title",
          "no_fade_edges",
          "hide_resize_handles",
          "hide_edge_types"
        ],
        "properties": {
          "hide_edge_types": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EdgeTypeDiscriminants"
            }
          },
          "hide_resize_handles": {
            "type": "boolean"
          },
          "left_zone_title": {
            "type": "string"
          },
          "no_fade_edges": {
            "type": "boolean"
          }
        }
      },
      "TopologyOptions": {
        "type": "object",
        "required": [
          "local",
          "request"
        ],
        "properties": {
          "local": {
            "$ref": "#/components/schemas/TopologyLocalOptions"
          },
          "request": {
            "$ref": "#/components/schemas/TopologyRequestOptions"
          }
        }
      },
      "TopologyRequestOptions": {
        "type": "object",
        "required": [
          "group_docker_bridges_by_host",
          "hide_vm_title_on_docker_container",
          "hide_ports",
          "left_zone_service_categories",
          "hide_service_categories",
          "show_gateway_in_left_zone"
        ],
        "properties": {
          "group_docker_bridges_by_host": {
            "type": "boolean"
          },
          "hide_ports": {
            "type": "boolean"
          },
          "hide_service_categories": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceCategory"
            }
          },
          "hide_vm_title_on_docker_container": {
            "type": "boolean"
          },
          "left_zone_service_categories": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceCategory"
            }
          },
          "show_gateway_in_left_zone": {
            "type": "boolean"
          }
        }
      },
      "TransportProtocol": {
        "type": "string",
        "enum": [
          "Udp",
          "Tcp"
        ]
      },
      "TypeMetadata": {
        "type": "object",
        "required": [
          "id",
          "name",
          "description",
          "category",
          "icon",
          "color",
          "metadata"
        ],
        "properties": {
          "category": {
            "type": [
              "string",
              "null"
            ]
          },
          "color": {
            "$ref": "#/components/schemas/Color"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "icon": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string"
          },
          "metadata": {},
          "name": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "UpdateEmailPasswordRequest": {
        "type": "object",
        "properties": {
          "email": {
            "type": [
              "string",
              "null"
            ],
            "format": "email"
          },
          "password": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "UpdateHostRequest": {
        "type": "object",
        "description": "Request type for updating a host with its children.\nUses the same input types as CreateHostRequest.\nServer will sync children (create new, update existing, delete removed).",
        "required": [
          "id",
          "name",
          "hidden",
          "tags"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "expected_updated_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "Optional: expected updated_at timestamp for optimistic locking."
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/InterfaceInput"
            },
            "description": "Interfaces to sync with this host.\nServer will create/update/delete to match this list."
          },
          "name": {
            "type": "string"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PortInput"
            },
            "description": "Ports to sync with this host.\nServer will create/update/delete to match this list."
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ServiceInput"
            },
            "description": "Services to sync with this host.\nServer will create/update/delete to match this list."
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        }
      },
      "User": {
        "allOf": [
          {
            "$ref": "#/components/schemas/UserBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "created_at",
              "updated_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "UserApiKey": {
        "allOf": [
          {
            "$ref": "#/components/schemas/UserApiKeyBase"
          },
          {
            "type": "object",
            "required": [
              "id",
              "updated_at",
              "created_at"
            ],
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "UserApiKeyBase": {
        "type": "object",
        "required": [
          "key",
          "name",
          "user_id",
          "organization_id",
          "last_used",
          "tags"
        ],
        "properties": {
          "expires_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "key": {
            "type": "string",
            "readOnly": true
          },
          "last_used": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "readOnly": true
          },
          "name": {
            "type": "string"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Network IDs this key has access to (hydrated from junction table)"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "user_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "UserApiKeyResponse": {
        "type": "object",
        "description": "Response for user API key creation/rotation\nContains the full API key record plus the plaintext key (shown only once)",
        "required": [
          "api_key",
          "key"
        ],
        "properties": {
          "api_key": {
            "$ref": "#/components/schemas/UserApiKey"
          },
          "key": {
            "type": "string",
            "description": "The plaintext API key - only returned once during creation or rotation"
          }
        }
      },
      "UserBase": {
        "type": "object",
        "required": [
          "email",
          "organization_id",
          "permissions",
          "network_ids"
        ],
        "properties": {
          "email": {
            "type": "string"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "oidc_linked_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "oidc_provider": {
            "type": [
              "string",
              "null"
            ]
          },
          "oidc_subject": {
            "type": [
              "string",
              "null"
            ]
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "terms_accepted_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "readOnly": true
          }
        }
      },
      "UserOrgPermissions": {
        "type": "string",
        "enum": [
          "Owner",
          "Admin",
          "Member",
          "Viewer"
        ]
      },
      "Uxy": {
        "type": "object",
        "required": [
          "x",
          "y"
        ],
        "properties": {
          "x": {
            "type": "integer",
            "minimum": 0
          },
          "y": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "VersionHealthStatus": {
        "type": "string",
        "description": "Health status for daemon versions",
        "enum": [
          "Current",
          "Outdated",
          "Deprecated"
        ]
      },
      "VersionInfo": {
        "type": "object",
        "description": "Version information for API compatibility checking",
        "required": [
          "api_version",
          "server_version"
        ],
        "properties": {
          "api_version": {
            "type": "integer",
            "format": "int32",
            "description": "Current API version (integer, increments on breaking changes)",
            "minimum": 0
          },
          "min_compatible_client": {
            "type": [
              "string",
              "null"
            ],
            "description": "Minimum client version that can use this API (optional, for future use)"
          },
          "server_version": {
            "type": "string",
            "description": "Server version (semver)",
            "example": "0.12.10"
          }
        }
      }
    },
    "securitySchemes": {
      "daemon_api_key": {
        "type": "apiKey",
        "in": "header",
        "name": "Authorization",
        "description": "Daemon API key (Bearer scp_d_...). Requires X-Daemon-ID header."
      },
      "session": {
        "type": "apiKey",
        "in": "cookie",
        "name": "session_id",
        "description": "Browser session cookie. Obtained via /api/auth/login."
      },
      "user_api_key": {
        "type": "apiKey",
        "in": "header",
        "name": "Authorization",
        "description": "User API key (Bearer scp_u_...). Create in Platform > API Keys."
      }
    }
  },
  "tags": [
    {
      "name": "api_keys",
      "description": "API keys for daemon authentication. Create and manage keys that allow daemons to communicate with the server."
    },
    {
      "name": "auth",
      "description": "Authentication and session management. Handle user login, logout, and session state."
    },
    {
      "name": "config",
      "description": "Server configuration. Public configuration settings for client applications."
    },
    {
      "name": "daemon_api_keys",
      "description": "Daemon API keys for scanner authentication. Create and manage keys that allow daemons to authenticate with the server and submit discovery results."
    },
    {
      "name": "discoveries",
      "description": "Network discovery operations. Trigger and monitor scans that detect hosts, services, and network topology."
    },
    {
      "name": "github",
      "description": "GitHub integration endpoints."
    },
    {
      "name": "ports",
      "description": "Ports that have been scanned and found open on a host"
    },
    {
      "name": "bindings",
      "description": "\n            ## Binding Types\n            - **Interface binding**: Service is present at an interface (IP address) without a specific port.\n              Used for non-port-bound services like gateways.\n            - **Port binding (specific interface)**: Service listens on a specific port on a specific interface.\n            - **Port binding (all interfaces)**: Service listens on a specific port on all interfaces\n              (`interface_id: null`).\n        "
    },
    {
      "name": "groups",
      "description": "Logical groupings of hosts. Organize hosts into groups for easier management and visualization."
    },
    {
      "name": "hosts",
      "description": "Network hosts (devices). Manage discovered or manually created hosts on your network."
    },
    {
      "name": "interfaces",
      "description": "Network interfaces on hosts. Each host can have multiple interfaces with different IP addresses."
    },
    {
      "name": "invites",
      "description": "Organization invitations. Invite users to join your organization."
    },
    {
      "name": "metadata",
      "description": "Entity metadata registry. Schema information for all entity types in the system."
    },
    {
      "name": "networks",
      "description": "Network containers. Top-level organizational unit that contains subnets, hosts, and other entities."
    },
    {
      "name": "organizations",
      "description": "Manage organization settings."
    },
    {
      "name": "services",
      "description": "Services running on hosts. Detected or manually added services like databases, web servers, etc."
    },
    {
      "name": "shares",
      "description": "Shared network views. Create read-only shareable links to your network topology."
    },
    {
      "name": "subnets",
      "description": "IP subnets within networks. Define address ranges and organize hosts by subnet."
    },
    {
      "name": "system",
      "description": "System information endpoints. Version and compatibility checking."
    },
    {
      "name": "tags",
      "description": "Custom tags for categorization. Apply labels to entities for filtering and organization."
    },
    {
      "name": "user_api_keys",
      "description": "User API keys for programmatic access. Create and manage personal API keys with scoped permissions for automation and integrations."
    },
    {
      "name": "users",
      "description": "User account management. Manage user profiles and permissions within organizations."
    }
  ]
}